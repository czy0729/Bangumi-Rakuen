{"id":351036,"avatar":"//lain.bgm.tv/pic/user/m/000/44/17/441758.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"昨天突然想给nginx加一个fair模块，上网查了一下发现要重新编译，于是下载了<br>openssl-1.0.2s<br>pcre-8.40<br>zlib-1.2.11<br>然后在openssl目录下执行了<br><div class=\"codeHighlight\"><pre><br>perl Configure VC-WIN64A no-asm<br>ms\\do_win64a<br></pre></div><br>然后用msys生成了makefile文件<br><div class=\"codeHighlight\"><pre><br>auto/configure --with-cc=cl --builddir=build --prefix= \\<br>--conf-path=conf/nginx.conf --pid-path=logs/nginx.pid \\<br>--http-log-path=logs/access.log --error-log-path=logs/error.log \\<br>--sbin-path=nginx.exe --http-client-body-temp-path=temp/client_body_temp \\<br>--http-proxy-temp-path=temp/proxy_temp \\<br>--http-fastcgi-temp-path=temp/fastcgi_temp \\<br>--with-cc-opt=-DFD_SETSIZE=1024 --with-pcre=build/lib/pcre-8.40 \\<br>--with-zlib=build/lib/zlib-1.2.11 --with-openssl=build/lib/openssl-1.0.2s \\<br>--with-select_module --with-http_ssl_module \\<br>--with-http_sub_module \\<br>--add-module=build/lib/nginx-upstream-fair-master<br></pre></div><br>然后用VS2017的命令行工具编译，报错<br><div class=\"codeHighlight\"><pre><br>Building OpenSSL<br>        perl .\\util\\copy-if-different.pl \".\\crypto\\buildinf.h\" \"tmp32\\buildinf.h\"<br>Copying: ./crypto/buildinf.h to tmp32/buildinf.h<br>        perl .\\util\\copy-if-different.pl \".\\crypto\\opensslconf.h\" \"inc32\\openssl\\opensslconf.h\"<br>NOT copying: ./crypto/opensslconf.h to inc32/openssl/opensslconf.h<br>        ml /nologo /Cp /coff /c /Cx /Zi /Fotmp32\\sha1-586.obj tmp32\\sha1-586.asm<br>Assembling: tmp32\\sha1-586.asm<br>tmp32\\sha1-586.asm(1432) : error A2070:invalid instruction operands<br>tmp32\\sha1-586.asm(1576) : error A2070:invalid instruction operands<br>NMAKE : fatal error U1077: “D:\\VisualStudio\\C++\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX86\\x86\\ml.EXE”: 返回代码“0x1”<br>Stop.<br>NMAKE : fatal error U1077: “if”: 返回代码“0x2”<br>Stop.<br>NMAKE : fatal error U1077: “D:\\VisualStudio\\C++\\VC\\Tools\\MSVC\\14.16.27023\\bin\\HostX86\\x86\\nmake.exe”: 返回代码“0x2”<br>Stop.<br></pre></div><br>有大佬知道这个怎么解决吗，网上查了一下没找到解决方法<br>第一次编译程序，如果是什么低级错误也请指出 ","time":"2019-6-7 09:47","title":"问一个关于Windows下编译nginx的问题","userId":"441758","userName":"snylonue","userSign":"(表达能力极差)"}
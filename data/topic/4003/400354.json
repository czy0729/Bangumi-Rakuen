{"id":400354,"avatar":"//lain.bgm.tv/pic/user/m/000/13/14/131492.jpg","floor":"#1","group":"SelfHost _è‡ªå»ºNASä¸åª’ä½“åº“","groupHref":"/group/nas","groupThumb":"","message":"Lokiçš„å®‰è£…æ–¹å¼ï¼š<a href=\"https://grafana.com/docs/loki/latest/setup/install/local/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://grafana.com/docs/loki/latest/setup/install/local/</a><br>æˆ‘è¿™é‡Œé‡‡ç”¨æœ¬åœ°å®‰è£…äº†ï¼Œåº”ä¸ºwinä¸Šdockeræ˜¯è·‘åœ¨hypervé‡Œï¼Œæ€§èƒ½ä¸æ˜¯å¾ˆå¼ºè€Œä¸”ç£ç›˜å ç”¨ä¹Ÿå¤§ã€‚<br>é¦–å…ˆæŒ‰ç…§æ•™ç¨‹ä¸‹è½½å¥½äºŒè¿›åˆ¶å’Œé…ç½®æ–‡ä»¶<br><a href=\"https://github.com/grafana/loki/releases/download/v2.9.8/loki-windows-amd64.exe.zip\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/grafana/loki/ ... ndows-amd64.exe.zip</a><br><a href=\"https://github.com/grafana/loki/releases/download/v2.9.8/promtail-windows-amd64.exe.zip\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/grafana/loki/ ... ndows-amd64.exe.zip</a><br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-221205.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>æŒ‰ç…§æ•™ç¨‹å¯åŠ¨è¯•è¯•<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-205102.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>ç›´æ¥æŠ¥é”™ï¼ŒæŸ¥äº†ä¸‹ä¸åº”è¯¥ç”¨mainåˆ†æ”¯çš„ç®€å•é…ç½®ï¼Œæ¢æˆæˆ‘ä¸‹è½½çš„ç‰ˆæœ¬åˆ†æ”¯å¯¹åº”çš„ç®€å•é…ç½®ï¼š<br><a href=\"https://github.com/grafana/loki/blob/v2.9.8/cmd/loki/loki-local-config.yaml\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/grafana/loki/ ... i-local-config.yaml</a><br><br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-205102.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>å¯ä»¥å¯åŠ¨äº†ï¼š<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-205710.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>æ¥ä¸‹æ¥åœ¨grafanaçš„æ•°æ®æºé‡Œæ·»åŠ ä¸€ä¸‹Lokiï¼Œé»˜è®¤é…ç½®æ–‡ä»¶ç”¨çš„å°±æ˜¯3100ç«¯å£ï¼Œé…ç½®å…¶å®ä»€ä¹ˆéƒ½ä¸ç”¨æ”¹<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-205826.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-210053.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>ä¹‹åé…ç½®ä¸€ä¸‹Promtailé‡‡é›†NASä¸ŠæœåŠ¡æ‰“å°çš„æ—¥å¿—æ–‡æœ¬ï¼Œè¿™é‡Œå› ä¸ºæˆ‘ä½¿ç”¨winswå°è£…æœåŠ¡ï¼Œæ—¥å¿—éƒ½ç»Ÿä¸€æ‰“å°åœ¨äº†~/Desktop/logsæ–‡ä»¶å¤¹<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-221953.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>å¯åŠ¨ä¸€ä¸‹promtailè¯•è¯•<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-222115.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>å¼€å§‹æ”¶é›†æ—¥å¿—äº†<br><br>è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºæˆ‘çš„æ—¥å¿—æ¯”è¾ƒå¤§ï¼Œéœ€è¦lokiè§£é™¤ä¸‹é™åˆ¶æ‰èƒ½æ¨é€è¿‡å»<br>ç½‘ä¸Šéšæ‰‹å¤åˆ¶çš„é…ç½®<br><div class=\"codeHighlight\"><pre><br>limits_config:<br>Â Â retention_period: 72h<br>Â Â enforce_metric_name: false<br>Â Â reject_old_samples: true<br>Â Â reject_old_samples_max_age: 168h<br>Â Â max_cache_freshness_per_query: 10m<br>Â Â split_queries_by_interval: 15m<br>Â Â # for big logs tune<br>Â Â per_stream_rate_limit: 512M<br>Â Â per_stream_rate_limit_burst: 1024M<br>Â Â cardinality_limit: 200000<br>Â Â ingestion_burst_size_mb: 1000<br>Â Â ingestion_rate_mb: 10000<br>Â Â max_entries_limit_per_query: 1000000<br>Â Â max_label_value_length: 20480<br>Â Â max_label_name_length: 10240<br>Â Â max_label_names_per_series: 300<br></pre></div><br><br>ä¹‹ååœ¨Grafanaé‡Œå°±å¯ä»¥æœç´¢æ—¥å¿—äº†<br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-231007.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><img src=\"https://azusebox.moe/wp-content/uploads/2024/06/screenshot-20240618-231001.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>ä¸è¿‡labelæ¯”è¾ƒå°‘ï¼Œä¸å¤ªå¥½åŒºåˆ†ï¼Œå¯ä»¥åˆ©ç”¨promtailçš„æ­£åˆ™relabelé‡æ–°ä»æ–‡ä»¶åé‡Œæå–æ ‡ç­¾<br>æˆ‘é…ç½®äº†æå–ä¸è¿‡æ²¡æœ‰ç”Ÿæ•ˆï¼Œæ—¶é—´å¤ªæ™šï¼Œå°±ä¸‹æ¬¡å†æ’æŸ¥å§<br><div class=\"codeHighlight\"><pre><br>scrape_configs:<br>- job_name: system<br>Â Â static_configs:<br>Â Â - targets:<br>Â  Â Â  Â - localhost<br>Â  Â  labels:<br>Â  Â Â  Â job: varlogs<br>Â  Â Â  Â __path__: \"C:/Users/azuse/Desktop/logs/*.log\"<br>Â  Â Â  Â stream: stdout<br>Â Â relabel_configs:<br>Â Â - source_labels: <br>Â  Â  - filename<br>Â  Â  regex: (.*?)_(.*?)\\.(.*?)\\.log<br>Â  Â  target_label: 'service'<br>Â  Â  replacement: '$1'<br></pre></div>","time":"2024-6-18 23:16","title":"Lokié‡‡é›†NASæ—¥å¿—å¹¶ç”¨GrafanaæŸ¥çœ‹","userId":"misakaxindex","userName":"æ±ç€¬ã¾ã¤ã‚ŠğŸ¦‹â„ï¸ğŸ»ğŸ’ğŸºğŸğŸ ","userSign":"([s]å®‰é™ç‚¹æ ¼å­[/s] â˜„ï¸âš“ â˜ï¸â­ï¸)"}
{"id":367485,"avatar":"//lain.bgm.tv/pic/user/m/000/13/14/131492.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"要管理的文件：<br>（1）各类型电影动画电视剧，可能是一个bt文件文件夹，也可能是一个裸mp4文件，因为有的是bt下载，有的是百度云下载，分散在电脑不同文件夹，并且和其他文件夹杂在一起。<br>（2）p站推特图片，这个需求其实不大，chrome保存的时都候选同一个文件夹就好了，就是图片数量上万之后，windows资源管理器排序比较慢。<br>（3）非常想实现的需求，电脑上音声文件夹管理，从南＋下的音声，基本是百度云下载，和电影电视文件夹杂在一起，并且文件夹没有很好的命名，音声听了一半也不能保存播放进度<br>（4）3dm正版游戏<img src=\"/img/smiles/tv/14.gif\" smileid=\"53\" alt=\"(bgm37)\">，也是百度云下载，但是因为文件夹比较大经常移来移去，最后移到一个地方就忘了有这个游戏，最好能统一管理<br><br>简单来说，就是本体媒体播放能和netflix在线播放一个体验，本地刷图片能有pixiv上一个体验，本体听音声能和dlsite在线播放一个体验，（这些流媒体网站前端是做的真不错<img src=\"/img/smiles/tv/12.gif\" smileid=\"51\" alt=\"(bgm35)\">），本体游戏浏览能和steam一个体验（这个好像直接steam添加本地游戏就行）<img src=\"/img/smiles/tv/14.gif\" smileid=\"53\" alt=\"(bgm37)\"><br><br>设置一定要简单，前端一定要好看，支持的媒体文件种类多，播放快<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br><br>最简单的版本我想就是支持扫描媒体和自己添加文件夹的播放器，类似安卓上常见的相册工具，或者mxplayer，并且支持断点续播。查来查去只查到个plex media server，前端还不错，但播放都要dlna，在本机播放这样似乎有点多此一举...<br><br>-----------------------------更新-------------------------<br>（1）（3）已经用上了jellyfin和kikoeru一段时间，两款开源app都特别棒<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"> 遇到的问题基本都解决了，看着首页真的的舒服。jellyfin不止可以看电影、看番，还可以看电视直播、听音乐<img src=\"/img/smiles/tv/02.gif\" smileid=\"41\" alt=\"(bgm25)\">。客户端多，安卓平板，安卓电视都有jellyfin客户端，随时随地都有web都可以放，也不用担心视频格式不支持<span class=\"text_mask\" style=\"background-color:#555;color:#555;border:1px solid #555;\">，服务器实时ffmpeg转码（当然还是不转码直接串流快，服务器风扇也不用起飞）</span>。对字幕、音轨的支持也很好，ass srt内置还是外挂基本都能没问题读出来，就是文件命名和文件夹组织上有些技巧，得用一段时间才熟悉。<br>（2）（4）还没有任何改变<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br><br>附上我现在的jellyfin和kikoeru<br><img src=\"http://azusebox.moe/wp-content/uploads/2022/05/screenshot-20220507-011528.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>推荐一下我自己修改版的<a href=\"https://github.com/azuse/kikoeru-express\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">kikoeru</a>，增加了历史记录功能。<span class=\"text_mask\" style=\"background-color:#555;color:#555;border:1px solid #555;\">遇到音频断流的问题不知道有没有大佬知道怎么解，组件用的是vue-plyr，不太知道断流时候是什么情况，拖一下进度条能好<img src=\"/img/smiles/tv/95.gif\" smileid=\"134\" alt=\"(bgm118)\"></span><br><br><span style=\"font-size:20px; line-height:20px;\">Jellyfin追番一定要配合<a href=\"https://github.com/EstrellaXD/Auto_Bangumi\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">autobangumi</a>使用，省去了下载文件、整理文件的很多繁琐，下载下来自动重命名，可直接可以导入媒体库，<span style=\"font-weight:bold;\">并且不影响做种</span>。</span>用上之后配合这个插件<a href=\"https://github.com/kookxiang/jellyfin-plugin-bangumi\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">kookxiang/jellyfin-plugin-bangumi</a>，可以播放完在bangumi自动点“看过”<br><br>------------------------记录一个坑------------------<br>如果你在windows上使用jellyfin或者emby媒体服务器，他们使用的ffprobe和ffmpeg可能遇到windows文件名长度限制导致视频无法播放出来，windows10系统和jellyfin/emby都增加了长文件路径支持，但遗憾的是ffmpeg没有。<br>解决这一个问题可以把jellyfin/emby自带的ffmpeg/ffprobe替换成这个已经patch过的版本<br><a href=\"https://github.com/yt-dlp/FFmpeg-Builds/releases/download/latest/ffmpeg-n5.0-latest-win32-gpl-shared-5.0.zip\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/yt-dlp/FFmpeg ... -gpl-shared-5.0.zip</a><br><br>详见：<br><a href=\"https://emby.media/community/index.php?/topic/91634-problem-long-pathslong-filename-259-characters-ffprobe-error/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://emby.media/community/ind ... ters-ffprobe-error/</a><br><a href=\"https://trac.ffmpeg.org/ticket/8885\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://trac.ffmpeg.org/ticket/8885</a><br><br>反馈了这个问题，<a href=\"https://github.com/jellyfin/jellyfin-ffmpeg/issues/145\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">ffmpeg/ffprobe long path problem on windows</a>，nyanmisaka大佬已经在官方ffmpeg里修复了。<br>话说很多人推荐nyanmisaka的定制版jellyfin，我用起来感觉不太出区别<img src=\"/img/smiles/tv/45.gif\" smileid=\"84\" alt=\"(bgm68)\">，听说是编解码效率更高，要是前端有区别的话应该比较明显。<br><br>-----------------------更新一下---------------------<br>经过大家推荐，用上了<a href=\"https://github.com/Sonarr/Sonarr\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">sonarr</a>+<a href=\"https://github.com/Radarr/Radarr\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">radarr</a>+<a href=\"https://github.com/Fallenbagel/jellyseerr\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">jellyseerr</a><br>Sonarr是搜索&下载电视剧用的软件，windows下安装很方便，安装包点点点就行。Radarr是Sonarr的一个分支，Radarr可以用来搜索电影，而Sonarr只能用来搜索电视剧。Sonarr和Radarr都支持搜索、一键下载、监控电视剧/电影更新的能力。他们搜索依赖内置的BT源，或者使用一个BT网站聚合搜索器Jacket配置搜索。然后Sonarr和Radarr下载的电视剧电影就会直接保存到Jellyfin的媒体库文件夹里，并且带上元信息和海报，真正做到一键下载、导入。<br>附几个我配置Sonarr与Jacket时看的教程，流程很详细，一步一步走就行。有个问题，BT下载站RARBG和电影信息网站TMDB被墙了，可以在Sonarr和Jacket里配置使用代理上网。<br><a href=\"https://post.smzdm.com/p/a78zxord/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Jackett Sonarr Radarr 介绍</a><br><a href=\"https://www.bilibili.com/read/cv10864347\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">使用Sonarr+Jackett+qb/tr+emby实现（基本）全自动追新番</a><br><a href=\"https://sleele.com/2020/03/19/%E4%BD%BF%E7%94%A8sonarr%E4%B8%8B%E8%BD%BD%E5%8A%A8%E7%94%BB/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">使用Sonarr下载动画</a><br><a href=\"https://laosu.ml/2021/02/08/%E8%B5%84%E6%BA%90%E8%81%9A%E5%90%88%E6%90%9C%E7%B4%A2%E7%A5%9E%E5%99%A8Jackett/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">资源聚合搜索神器Jackett</a><br>会配置Sonarr之后，Radarr的配置和Sonarr完全一样，Radarr还更好一点，支持UI改成中文，<a href=\"https://github.com/Sonarr/Sonarr/issues/269\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Sonarr抓取影片信息只能抓英文的</a>，Radarr可以抓中文的（元数据里的Metadata Language）。<br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-211126.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>Jacket是Sonarr和Radarr使用的BT搜索工具，支持非常多的BT/PT网站，也是直接安装就能用了，配置照着教程一步一步来就行。<br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-211429.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>哦，Sonarr和Radarr当然需要BT下载客户端，我用的是Qbittorrent，使用AutoBangumi的时候配置过了，安装很简单，开机自启，需要配置的就是设置里打开web界面就行。<br><br>配置好Sonarr、Radarr、Jacket，一键搜索和下载电影、电视剧的能力就有了，但Sonarr和Radarr的前端还比较简陋，有人专门做了前端<a href=\"https://github.com/Fallenbagel/jellyseerr\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">JellySeer</a>，可以直接看到影片推荐和当下热门，然后一键推送到Sonarr Radarr下载，下载完后自动在Jellyfin显示，甚至可以共享给一起用Jellyfin的好朋友使用，用起来很棒。<br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-211814.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>JellySeer推荐使用Docker部署，我在Windows上原生环境的运行，需要nodejs、npm环境（nodejs更新很快，我用的是18），之后安装官方给的三个命令npm i -g win-node-env; yarn install; yarn run build; yarn start就可以运行了（当然你需要自己装yarn）。设置开机自启可以用，<a href=\"https://github.com/winsw/winsw\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">winsw</a>包装成windows服务，executable我设置的是一个<a href=\"https://gist.github.com/azuse/7f38063264e210723c3f912ea9625405\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">jellyseer.bat</a>，里头先设置npm的path，再yarn start。winsw很好用，强烈推荐，我觉得比nssm好。<br><br>还有一件事，Sonarr和Radarr下载的很多是Raw片源，如果是电视剧可能自带英语字幕，蓝光的话可能语言更多一些，但总有很多<span style=\"font-weight:bold;\">没有中文字幕</span>，可以使用<a href=\"https://github.com/allanpk716/ChineseSubFinder\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Cinese Sub Finder</a>这个软件，Windows安装也很简单，提供exe直接一键启动，用winsw包装成服务。配置傻瓜，用上之后电影字幕基本都能找到，但时间轴很多不对，设置里有个自动校正字幕时间轴，推荐打开。<br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-220156.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>-----------------------再更新一下---------------------这块和媒体库没啥关系了，可以省略。。<br>有了这么牛逼的媒体服务器，服务器状态的监控也得跟上。<br>以前一直用的<a href=\"https://www.netdata.cloud/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">NetData</a>，一键安装（Windows上不怎么一键，需要在wsl里安装，设置开机自启也比较麻烦）。NetData的好处就是一键安装、开箱即用，Metrics指标采集、数据库存储、前端展示仪表盘，全部一站式，采集的数据很全（CPU 硬盘 内存 网络 进程全都有），甚至不用你设置外网透传，可以直接通过NetData官方网站访问（当然这样比较慢），缺点是自定义程度低，接入Grafana麻烦。<br>如果你准备直接用NetData，可以看他们的安装文档，脚本一键安装：<a href=\"https://learn.netdata.cloud/docs/agent/packaging/installer/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://learn.netdata.cloud/docs/agent/packaging/installer/</a><br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-220239.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>如果需要更强大的监控（在Windows平台），那必须用上<a href=\"https://prometheus.io/download/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Promethues</a>和<a href=\"https://grafana.com/grafana/download\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Grafana</a>了，熟悉的同学一定很熟悉，不知道的同学使用起来学习曲线可能比较陡峭（并且和NAS没太大关系）<br>这一套包含三个部分：（1）采集信息的Exporter（比如<a href=\"https://github.com/prometheus-community/windows_exporter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Windows Exporter</a>，<a href=\"https://github.com/kallex/PromDapter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">HWInfo Exporter</a>，<a href=\"https://github.com/caseyscarborough/qbittorrent-exporter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Qbittorrent Exporter</a>）（2）存储数据的数据库，常用的有Promethues、InfluxDB（3）展示数据的仪表盘Grafana。刚刚说的NetData其实干了Exporter+DB+Grafana三个工具的事。<br><br>Prometheus在Windows上不用安装，下载下来直接运行。用winsw包装成windows服务。<br><br>Exporter我目前用了三个：<br>一个是定番<a href=\"https://github.com/prometheus-community/windows_exporter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Windows Exporter</a>，采集Windows系统信息：包括CPU 网速 磁盘分区读写 进程CPU占用，没有进程网速比较遗憾。<br>第二个是采集硬件信息的<a href=\"https://github.com/kallex/PromDapter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">HWinfo64 Exporter</a>，HWinfo64可以采集CPU频率 功耗 GPU频率 功耗 网速 磁盘SMART信息 风扇转速等硬件信息，更加全面监控机器。要用Exporter必须打开HWinfo64的Share memory功能，并且打开着Sensor页面，7.0之后share memory变成了收费功能，只能用7.0以前的版本了。<br>第三个是监控Qbittorrent信息的，有两个选择，一个是python写的<a href=\"https://github.com/esanchezm/prometheus-qbittorrent-exporter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">prometheus-qbittorrent-exporter</a>，另一个是Java写的<a href=\"https://github.com/caseyscarborough/qbittorrent-exporter\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">qbittorrent-exporter</a>，python写的更容易跑起来（因为我不用docker），但数据采集的很少，推荐Java写的那个。<br><br>Grafana在Windows上也是直接安装，装好之后设置下数据源为本机的Promethues，之后就可以导入仪表盘了<br><br>三个Exporter分别对应三个仪表盘：<br>Windows Exporter：网上找的面板，做了一些调整。<a href=\"https://gist.github.com/azuse/a9ef1bf6c734d8fc0acee657b6b0cb69\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">JSON导出</a><br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/windowsexportwe.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>HWinfo Exporter：网上找的面板，做了一些调整。<a href=\"https://gist.github.com/azuse/1a4861e02417e811f801d5b6780e7e75\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">JSON导出</a><br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/hwexporter.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>Qbittorrent Exporter：这个是python版的那个，我还没用上Java版的那个，面板就是作者给的，没做修改<br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-02-224853.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>Java版的那个Qbittorrent Exporter，比python版的好很多，作者为啥不给个jar...自己进docker把运行文件拷贝出来，可以在windows native运行：<a href=\"https://gist.github.com/azuse/c3b2ec9f8381754d820494503db4438d\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">JSON面板</a><br><img src=\"https://azusebox.moe/wp-content/uploads/2022/11/屏幕截图-2022-11-03-021500.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br><br><br>光监控机器的话用<a href=\"https://github.com/influxdata/telegraf\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">TeleGraf</a>也行，这个没有仔细研究 ","time":"2022-1-31 05:45","title":"下载党本地媒体库怎么管理？","userId":"misakaxindex","userName":"東瀬まつり🦋❄️🐻💎🐺🍎🐠","userSign":"([s]安静点格子[/s] ☄️⚓ ☁️⭐️)"}
{"id":374807,"avatar":"//lain.bgm.tv/pic/user/m/000/30/41/304116.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"230403：<br><br>得益于超展开改版, 日志的相关更新会被顶上来, 样例网站现支持查看日志的历史版本。<br><br><span style=\"text-decoration: line-through;\">另由于「贴贴」功能的加入, 讨论帖主题模板改版, 原来的解析失效, 所以样例网站原json格式的API暂时停止工作。</span> 已修复<br><br>提供一个UserScript方便定位到历史页。<br><a href=\"https://openuserjs.org/scripts/gyakkun/Show_History_Link_in_Group_and_Subject_Topic_Alpha\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://openuserjs.org/scripts/g ... Subject_Topic_Alpha</a><br><img src=\"https://p.sda1.dev/10/420edef921c3d5f755d2b381947422f8/image.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>服务器比较弱, 如遇繁忙/报错请耐心等待。<br><br>----------------------<br><br>230319:<br><br>已经稳定运行一段时间了 (指基本没人用)。新增可读日期页, 毕竟不是每个人类都会认Unix时间戳。<br><br>GET /history/(subject|group)/:topicId/link<br><br>e.g.<br><a href=\"https://bgm.nyamori.moe/history/subject/892/link\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892/link</a><br><a href=\"https://bgm.nyamori.moe/history/group/374807/link\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/group/374807/link</a><br><br>另外样例网站和爬取服务是在两个不同的服务器上, 最多会有~2h的延迟。<br><br>----------------------<br><br>221117: <br><br>感谢老板首肯。样例网站会继续运行下去。<br><br>新增以下请求路径:<br><br>GET /history/(subject|group)/:topicId/latest : 会自动302跳到最新的json<br>GET /history/(subject|group)/:topicId/:millisecondTimestamp/html: 会显示原始爬下来的html<br>GET /history/(subject|group)/:topicId/latest/html: 会显示最新爬到的html<br><br>e.g.<br><a href=\"https://bgm.nyamori.moe/history/subject/892/latest\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892/latest</a><br><a href=\"https://bgm.nyamori.moe/history/subject/892/1668434660993/html\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892/1668434660993/html</a><br><a href=\"https://bgm.nyamori.moe/history/subject/892/latest/html\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892/latest/html</a><br>----------------------<br><br>221115:<br><br>代码 <br><a href=\"https://github.com/gyakkun/bgm-archive-sh\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/gyakkun/bgm-archive-sh</a><br><a href=\"https://github.com/gyakkun/bgm-archive-kt\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/gyakkun/bgm-archive-kt</a><br><br>请求路径: <br>GET /history/(subject|group)/:topicId<br>GET /history/(subject|group)/:topicId/:millisecondTimestamp<br>Unix毫秒时间戳不存在的话会302往前跳到最近的一个, 太早的话会跳到第一个<br><br>响应格式: JSON, 具体自己看<br><br>样例网站 (Since ~2022-11-04):<br><a href=\"https://bgm.nyamori.moe/history/subject/892\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892</a><br><a href=\"https://bgm.nyamori.moe/history/subject/892/1668434660993\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.nyamori.moe/history/subject/892/1668434660993</a><br>学姐楼由于量太大, 解析结果不一定是准确的。其他小楼估计还可以。<br><br>前端? 额, 没时间搓了, 欢迎来搓。<br><br><a href=\"/user/sai\" class=\"l\">@Sai&#x1F596;</a> 置评请求, 如果有违任何使用条款, 上述样例网站会立即停止服务。 ","time":"2022-11-15 23:17","title":"[230403 Update] 新增日志支持 | 搓了个bgm讨论贴专用archive","userId":"304116","userName":"gyakkun","userSign":""}
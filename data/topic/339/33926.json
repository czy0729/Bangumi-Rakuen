{"id":33926,"avatar":"//lain.bgm.tv/pic/user/m/000/00/70/7088.jpg","floor":"#1","group":"靠谱人生茶话会","groupHref":"/group/boring","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/03/364.jpg","message":"2014-8-21：<br><br>更新：<br>增加恢复功能，使用时加 -r / --restore 参数，从本地读取文件<br><br>---------------------------------------------------------------------------------------------------------------<br>2014-8-20：<br><br>大家好，我又来了，这次搞了个bangumi条目导出到本地以及批量删除的工具<br><br>代码在<br><a href=\"https://github.com/hentaiPanda/bgm_tenkou\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://github.com/hentaiPanda/bgm_tenkou</a><br><br>这是一个python3工具<br>装过python的和nix用户应该不用讲了（不过我没有在nix上测试过）<br><br><br>下面对不懂的说一下安装方法<br><br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">首先安装python环境</span></span><br><br>到 <a href=\"https://www.python.org/downloads/\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://www.python.org/downloads/</a> 下载左边的『Download Python 3.4.1』并安装<br><br>再到 <a href=\"https://github.com/hentaiPanda/bgm_tenkou\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://github.com/hentaiPanda/bgm_tenkou</a> 点击右下角的『Download ZIP』 下载完成后解压即可使用<br><br>(这是命令行工具，不是双击启动的)<br><br><br>因为考虑网速问题，我在百度盘也放了一份<br><br><a href=\"http://pan.baidu.com/s/1mgkKTy4\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://pan.baidu.com/s/1mgkKTy4</a><br><br>密码：s89m<br><br>python也在里面<br><br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">使用方法</span></span><br><br>Bangumi有时候连接情况不太好，会一直卡在某个地方<br><br>Don't panic!<br><br>如果是网络情况不好可以换个时间再试<br><br>参数说明：<br><br><div class=\"codeHighlight\"><pre><br>tenkou.py [-h] [-d {chii.in,bgm.tv,bangumi.tv}] [-u UID]<br>          [--password PASSWORD] [--wipe] [-p PATH] [--auth AUTH]<br>          [--useragent USERAGENT] [--authfile AUTHFILE] [-v]</pre></div><br><br><br><div class=\"codeHighlight\"><pre><br>-h, --help                  帮助<br>-d DOMAIN, --domain DOMAIN  选择域名，默认bgm.tv, 还可选择bangumi.tv或chii.in<br>-u UID, --uid UID           你的id<br>--password PASSWORD         你的网站登录密码<br>-p PATH, --path PATH        本地保存目录，必须事先建立<br>--auth AUTH                 auth字符串<br>--useragent USERAGENT       你浏览器的User-Agent<br>--authfile AUTHFILE         保存User-Agent和Auth字符串的文件（Authfile）位置<br>--wipe                      删除所有条目！谨慎使用！<br>-r, --restore               恢复条目<br>-v, --version               程序版本<br></pre></div><br><br>只有id是必须的，不需要导出进度的话，不必输入密码<br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">使用举例</span></span><br><br>以下只是举例，你可以自由搭配<br><div class=\"codeHighlight\"><pre><br>1. tenkou.py -u 9999999                  导出id为9999999那人的条目<br><br>2. tenkou.py -u 9999999 -p ./bgm_backup  备份到当前位置的bgm_backup目录<br><br>3. tenkou.py -u 9999999 --password 123<br>                                         使用密码登录，导出id为9999999的条目，包括观看进度<br><br>4. tenkou.py -u 9999999 --useragent Mozilla --auth LFJDSLAF%LFASJD<br>                                         使用auth，导出id为9999999的条目，包括观看进度<br><br>5. tenkou.py -u 9999999 --authfile ./authfile.txt<br>                                         使用authfile，导出id为9999999的条目，包括观看进度<br><br>6. tenkou.py -u 9999999 --password 123 --wipe<br>                                         使用密码，导出id为9999999的条目，包括观看进度<br>                                         完全删除条目<br><br>7. tenkou.py -u 9999999 --useragent Mozilla --auth LFJDSLAF%LFASJD --wipe<br>                                         使用auth，导出id为9999999的条目，包括观看进度<br>                                         完全删除条目<br><br>8. tenkou.py -u 9999999 --authfile ./authfile.txt --wipe<br>                                         使用authfile，导出id为9999999的条目，包括观看进度<br>                                         完全删除条目<br><br>9. tenkou.py -u 9999999 --password 12345 -p ./backup -r<br>                                         使用密码，从当前工作目录下的backup目录读取文件，<br>                                         恢复id为9999999的条目</pre></div><br><br><span style=\"font-weight:bold;\">注：大量恢复或者删除条目过程中因为网络情况（你的连接问题或者服务器的保护机制，如果有的话）而出错的可能性会比较大。如果是恢复条目时，问题还不严重，因为本地文件还保留着。但在删除条目过程中如果发生错误，你会丢失条目记录或者删除不完全，所以虽然删除可以和导出同时进行，仍建议先导出一次再删除。</span><br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">获取Auth和User-Agent的方法</span></span><br><br>直接查看你浏览器的调试工具，这个Auth就是cookie里的Auth<br><br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">什么是Authfile</span></span><br><br>只是一个文本文件，保存了User-Agent和Auth字符串<br><br>其中，第一行是User-Agent；第二行是Auth字符串<br><br>authfile文件名任意，上面只是举例而用了authfile.txt<br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">需要同时提供密码和Auth吗？</span></span><br><br>不需要，密码、User-Agent和Auth、Authfile三选一即可<br><br>可以参考上面的使用举例<br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">有更简单的方法获取Auth和User-Agent吗？</span></span><br><br>和tenkou.py同时提供了一个getcookie.user.js的greasemonkey/tampermonkey脚本<br><br>安装后在bangumi页面可以查看并自动复制你的User-Agent/Auth，你可以手动分拆开来输入，或者直接新建一个authfile<br><br>如图所示：<br><br>Firefox GM<br><br><img src=\"https://camo.githubusercontent.com/0c295434c1ff0dced2e37da8f163f85d640694b3/687474703a2f2f692e696d6775722e636f6d2f3247646152536e2e6a7067\" class=\"code\" alt><br><br>Chrome Tampermonkey<br><br><img src=\"https://camo.githubusercontent.com/fd61c1de87671aa140166c3635fd2570eb2c865a/687474703a2f2f692e696d6775722e636f6d2f51776b366666302e6a7067\" class=\"code\" alt><br><br>结果<br><br><img src=\"https://camo.githubusercontent.com/b307da7bb21c536091a162e158e3ff74b8a6e749/687474703a2f2f692e696d6775722e636f6d2f4e573349596e632e6a7067\" class=\"code\" alt><br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">安全性？你会知道我的密码吗？</span></span><br><br>不会，只是你本地和网站的通信，没有什么信息会传到我这里<br><br>至于密码和Auth方式，因为这个只是用cookie的auth，没什么大的差别<br><br><span style=\"font-size:15px; line-height:15px;\"><span style=\"font-weight:bold;\">最后生出的备份文件说明</span></span><br><br>最后的备份文件按<br><br>A段：<br><br>    动画（anime）<br>    音乐（music）<br>    游戏（game）<br>    书籍（book）<br>    三次元（real）<br><br>以及B段：<br><br>    在看（do）<br>    看过（collect）<br>    想看（wish）<br>    搁置（on_hold）<br>    抛弃（dropped）<br><br>来命名<br><br>组成形式为bangumi_A段_B段.txt<br><br>比如<br><br><div class=\"codeHighlight\"><pre>bangumi_anime_do.txt<br>bangumi_book_collect.txt</pre></div><br><br>最后大概是这种感觉<br><br><img src=\"http://i.imgur.com/XKEXfCQ.jpg\" class=\"code\" alt> ","time":"2014-8-20 00:49","title":"条目导出到本地 / 条目批量删除 [更新:增加恢复功能]","userId":"s23sui","userName":"ドール","userSign":""}
{"id":357935,"avatar":"//lain.bgm.tv/pic/user/m/000/26/12/261227.jpg","floor":"#1","group":"番組WIKI計画","groupHref":"/group/wiki","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/01/128.jpg","message":"添加人物需要wiki权限，所以没权限的目前用不到。至于添加书籍等可以去<a href=\"https://bgm.tv/group/topic/345469\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">[脚本] [2020/05/04] [v0.3.1] bangumi 创建条目助手</a><br><br><a href=\"https://greasyfork.org/zh-CN/scripts/407695-%E6%97%A5%E6%96%87wiki-%E8%90%8C%E7%99%BE%E6%B7%BB%E5%8A%A0%E4%BA%BA%E7%89%A9\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">安装地址</a><br><br><span style=\"font-weight:bold;\">功能：</span><br>1.自动从日文wiki/萌白上抓取角色/声优信息，如果没头像的话，会自动谷歌搜索一张图当做头像。角色会自动关联条目和声优。<br>2.可以直接全文替换一个条目。如果不小心重复了的话，能替换掉（再也不会有待回收条目了）<br><br>需要注意的点：<br>1.最好梯子环境下使用，萌白姑且不提，日文wiki因为基本上都要从谷歌抓图，所以从日文wiki抓信息的时候是必须要梯子的<br>2.只适用于单页面的角色，也就是角色/人物本身有单独页面的，因为这个脚本本质上抓的就是人物页面的简介以及边上的表格部分（表格会变成BGM的info，如果页面本身没有则留空）<br>3.虽然很多作品的条目格式和角色一样，但是加不了作品（因为bgm这边参数不一样）。由于前面有dalao写了抓作品的，所以我就不重复劳动了。<br><br>红框部分：<br><img src=\"https://p.sda1.dev/0/940bf5ff77ceca7a0cf1855167b2e3ec/中野梓 -zh.moegirl.org.cn.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>所以这种<a href=\"https://zh.moegirl.org.cn/%E4%B8%AD%E9%87%8E%E6%A2%93\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">页面</a>可以，<a href=\"https://zh.moegirl.org.cn/zh/%E5%90%B9%E5%93%8D!%E4%B8%8A%E4%BD%8E%E9%9F%B3%E5%8F%B7/%E7%AC%AC%E4%BA%8C%E5%B9%B4%E5%90%B9%E5%A5%8F%E4%B9%90%E9%83%A8%E6%88%90%E5%91%98%E4%BB%8B%E7%BB%8D#%E2%80%9C%E5%90%B9%E5%A5%8F%E4%B9%90%E9%83%A8%E5%91%98%E2%80%9DCAST\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这种</a>就不行。wiki百科一个道理。<br><br><br>小演示：（图大，流量慎点）<br>萌白加条目（图8.5M）：<br><a href=\"http://upload.ouliu.net/i/20200725103651zodyp.gif\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">http://upload.ouliu.net/i/20200725103651zodyp.gif</a><br><br>日文wiki（图4.5M）：<br><a href=\"https://p.sda1.dev/0/72b7fb32e176922eab2fdc07c54ce1b6/2222.gif\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://p.sda1.dev/0/72b7fb32e176922eab2fdc07c54ce1b6/2222.gif</a><br><br>使用方法的话其实界面里写的比较细节了。不过这边还是说下好了：<br><img src=\"https://p.sda1.dev/0/c684c96846c3e7a97155157b71b37570/shezhi.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><div class=\"quote\"><q>首先点选页面右边的“生成条目信息”按钮，然后在出来的界面里做配置。目前这个界面只会出现在页面最上面，所以如果没看到的话记得滚动条往回拉。（会自动读取上次配置，所以如果是系列作品角色的话，设置一次即可）<br>最上面三项是给虚拟角色用的，分别表示要关联的主条目、有CV需要关联的条目、关联角色的类型（主角、配角、客串）<br>如果添加的是现实人物，那这三项无视，有数值也不影响。<br><br>虚拟角色的话第四项选虚拟角色就行，现实人物照着钩就是了<br>第五项略过，字面意思。<br>第六个选项是编辑模式，也就是替换重复条目用的，直接讲需要替换的重复条目的id贴进去即可<br>最下面两个选项，“查重”那个是查询bgm上是有已有条目（不过由于萌白很多条目没日文名字，所以效果比较看脸），查重的时候，选择取消就不会添加条目。<br>“调试模式”的话一般用户用不到，直接关了就行。这个主要是方便开发者找bug的，开了调试模式的话，不会提交条目到bgm，只是会把相关信息输出到console里<br><br>全部设置完之后点'创建条目\"然后慢慢等一会儿即可。之后会有弹窗提示结果<br>另外由于萌白条目很多信息都比较杂乱，所以强烈建议加完后人工过一遍做修正（我本来想给萌白做个全自动纠错，结果发现pattern太多了，全写下去要命，而且有些也不太好实现）</q></div>欢迎各位试用以及提bug。要是有人愿意做修正就更好了（<br><span style=\"text-decoration: line-through;\">主要功能其实上周就写好了，不过写萌白和wiki的通用脚本拖到了现在</span><br><br><br>UPDATE:<br><span style=\"font-weight:bold;\">V0.2 2020/08/12</span><br>1.之前formhash（bgm wiki身份鉴权）存在本地后就不再更新了，但是实际上这个值会变，现在改成每天更新一次的方式。<br>2. 某些图片获取到了链接但是无法正常读取，出现这种情况的时候会直接返回空图片（原先未处理的时候转成blob会将页面内容转进去触发CF的检测墙导致无法添加条目） ","time":"2020-7-25 10:33","title":"[脚本]从日文wiki/萌百抓取人物到BGM","userId":"261227","userName":"chitanda＠Lv2","userSign":"(Make Bangumi Great Again!)"}
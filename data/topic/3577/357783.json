{"id":357783,"avatar":"//lain.bgm.tv/pic/user/m/000/26/12/261227.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"有个小feature要做：请求一张网络然后转成blob。<br>一开始fetch里没设置no-cors的时候浏览器直接给我报跨域错误，强行设置了no-cors，图片倒是能请求到了，结果blob里空空如也。看了好久没看出来问题。从两点弄到现在。然后去搜的时候发现：<br><span style=\"font-weight:bold;\">没设置cors头的图片转blob的时候会直接被丢弃</span><br>那你fecth那个cors参数意义何在啊<img src=\"/img/smiles/tv/07.gif\" smileid=\"46\" alt=\"(bgm30)\"><br>而且为什么图片都要cors，理解不了。搜到的解决方法基本上也都不是前端能解决的。最实际的一个方案是用个proxy站点来加载图片，但是总感觉很蛋疼。所以想问问有别的啥方案吗？<br><div class=\"codeHighlight\"><pre><br>async function imageToBlob(url){<br>        let res=await fetch(url,{<br>                mode:'no-cors'<br>        });<br>        let myBlob=await res.blob();<br>        return myBlob<br>}<br>    var charaAvatarUrl='https://p.sda1.dev/0/56978ac72c84752bfcbd4b5c9b92ada3/Deh4rxSVQAU8-9J.jpg';<br>            let values= await Promise.all([imageToBlob(charaAvatarUrl)]);<br>              let objectURL1 = URL.createObjectURL(values[0]);<br>              let image1 = document.createElement('img');<br>              image1.src = objectURL1;<br>              document.body.appendChild(image1)<br></pre></div><br><br>上面这代码只能在图床站点跑 ","time":"2020-7-18 04:07","title":"为什么js请求图片都要cors头啊","userId":"261227","userName":"chitanda＠Lv2","userSign":"(Make Bangumi Great Again!)"}
{"avatar":"//lain.bgm.tv/pic/user/m/000/13/14/131492.jpg","floor":"#1","group":"ï½æŠ€æœ¯å®…çœŸå¯æ€•ï½","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"æˆ‘æŒ‰ç…§<a href=\"http://www.runoob.com/w3cnote/android-tutorial-socket1.html\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">ç½‘ä¸Šçš„æ•™ç¨‹</a>å†™äº†ä¸€ä¸ªsocketæµ‹è¯•ç¨‹åº <br><br>socketæœåŠ¡å™¨ç”¨phpè„šæœ¬å†™çš„åœ¨è¿è¡ŒÂ  Â Â Â âˆš<br>åœ¨æ–°çº¿ç¨‹é‡Œè¿›è¡Œç½‘ç»œæ“ä½œÂ  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â âˆš<br>åœ¨AndroidMainFasté‡Œæ·»åŠ ç½‘ç»œæƒé™Â  Â Â Â âˆš<br><br>ä½†æ˜¯ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ¯æ¬¡çº¿ç¨‹æ‰§è¡Œåˆ°socket = new socket(host,ip)çš„æ—¶å€™å°±å¡ä½äº†ï¼ŒæŒ‰æ­¥æ‰§è¡Œèµ°åˆ°é‚£é‡Œä¹Ÿä¸çŸ¥é“å…‰æ ‡è·³åˆ°é‚£é‡Œå»äº†...<img src=\"/img/smiles/tv/19.gif\" smileid=\"58\" alt=\"(bgm42)\">ç„¶åç‚¹å‘é€çš„æ—¶å€™socketè¿˜æ˜¯nullè‡ªç„¶ç¨‹åºå°±é—ªé€€äº†...<br><br>å’ŒåŒå­¦æåˆ›æ–°é¡¹ç›®æ‰“ç®—åšä¸€ä¸ªåŸºäºåœ°å›¾çš„ç•™è¨€æ¢ç´¢appï¼Œéƒ½æ˜¯å®‰å“åˆå¿ƒè€…ä¹Ÿä¸çŸ¥é“é€šä¿¡æ–¹æ³•æ˜¯ç”¨socketè¿˜æ˜¯httpè¿˜æ˜¯åˆ«çš„ä»€ä¹ˆå¥½ï¼Œæƒ³æ±‚ä¸€äº›å»ºè®®<img src=\"/img/smiles/tv/10.gif\" smileid=\"49\" alt=\"(bgm33)\">ï¼ˆå®‰å“ä¸Šçš„socketæœ‰è½®å­å—ï¼Ÿï¼‰<br><br>é™„ä¸Šcode<br><div class=\"codeHighlight\"><pre>package moe.azusebox.socket_test_app_50;<br><br>import android.os.Bundle;<br>import android.os.Handler;<br>import android.os.Message;<br>import android.support.v7.app.AppCompatActivity;<br>import android.view.View;<br>import android.widget.Button;<br>import android.widget.EditText;<br>import android.widget.TextView;<br>import android.widget.Toast;<br><br>import java.io.BufferedReader;<br>import java.io.BufferedWriter;<br>import java.io.IOException;<br>import java.io.InputStreamReader;<br>import java.io.OutputStreamWriter;<br>import java.io.PrintWriter;<br>import java.net.Socket;<br><br><br>public class MainActivity extends AppCompatActivity implements Runnable {<br><br>Â  Â  //å®šä¹‰ç›¸å…³å˜é‡,å®Œæˆåˆå§‹åŒ–<br>Â  Â  private TextView txtshow;<br>Â  Â  private EditText editsend;<br>Â  Â  private Button btnsend;<br>Â  Â  private static final String HOST = \"45.32.20.244\";<br>Â  Â  private static final int PORT = 110;<br>Â  Â  private Socket socket = null;<br>Â  Â  private BufferedReader in = null;<br>Â  Â  private PrintWriter out = null;<br>Â  Â  private String content = \"\";<br>Â  Â  private StringBuilder sb = null;<br><br>Â  Â  //å®šä¹‰ä¸€ä¸ªhandlerå¯¹è±¡,ç”¨æ¥åˆ·æ–°ç•Œé¢<br>Â  Â  public Handler handler = new Handler() {<br>Â  Â Â  Â Â Â public void handleMessage(Message msg) {<br>Â  Â Â  Â Â  Â Â  Â if (msg.what == 0x123) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â  sb.append(content);<br>Â  Â Â  Â Â  Â Â  Â Â  Â  txtshow.setText(sb.toString());<br>Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â Â }<br><br>Â  Â Â  Â Â Â ;<br>Â  Â  };<br><br><br>Â  Â  @Override<br>Â  Â  protected void onCreate(Bundle savedInstanceState) {<br>Â  Â Â  Â Â Â super.onCreate(savedInstanceState);<br>Â  Â Â  Â Â Â setContentView(R.layout.activity_main);<br>Â  Â Â  Â Â Â sb = new StringBuilder();<br>Â  Â Â  Â Â Â txtshow = (TextView) findViewById(R.id.txtshow);<br>Â  Â Â  Â Â Â editsend = (EditText) findViewById(R.id.editsend);<br>Â  Â Â  Â Â Â btnsend = (Button) findViewById(R.id.btnsend);<br><br>Â  Â Â  Â Â Â //å½“ç¨‹åºä¸€å¼€å§‹è¿è¡Œçš„æ—¶å€™å°±å®ä¾‹åŒ–Socketå¯¹è±¡,ä¸æœåŠ¡ç«¯è¿›è¡Œè¿æ¥,è·å–è¾“å…¥è¾“å‡ºæµ<br>Â  Â Â  Â Â Â //å› ä¸º4.0ä»¥åä¸èƒ½å†ä¸»çº¿ç¨‹ä¸­è¿›è¡Œç½‘ç»œæ“ä½œ,æ‰€ä»¥éœ€è¦å¦å¤–å¼€è¾Ÿä¸€ä¸ªçº¿ç¨‹<br>Â  Â Â  Â Â Â new Thread() {<br><br>Â  Â Â  Â Â  Â Â  Â public void run() {<br>Â  Â Â  Â Â  Â Â  Â Â  Â  try {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â socket = new Socket(HOST, PORT);//å°±æ˜¯è¿™ä¸€æ­¥mmp<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â in = new BufferedReader(new InputStreamReader(socket.getInputStream(), \"UTF-8\"));<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  socket.getOutputStream())), true);<br>Â  Â Â  Â Â  Â Â  Â Â  Â  } catch (IOException e) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â e.printStackTrace();//è€Œä¸”å¹¶ä¸ä¼šthrowä»»ä½•ä¸œè¥¿<br>Â  Â Â  Â Â  Â Â  Â Â  Â  }<br>Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â Â }.start();<br><br>Â  Â Â  Â Â Â //ä¸ºå‘é€æŒ‰é’®è®¾ç½®ç‚¹å‡»äº‹ä»¶<br>Â  Â Â  Â Â Â btnsend.setOnClickListener(new View.OnClickListener() {<br><br>Â  Â Â  Â Â  Â Â  Â @Override<br>Â  Â Â  Â Â  Â Â  Â public void onClick(View v) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â  String msg = editsend.getText().toString();<br>Â  Â Â  Â Â  Â Â  Â Â  Â  if(socket == null)<br>Â  Â Â  Â Â  Â Â  Â Â  Â  {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â Toast.makeText(getApplicationContext(),\"socket initiate failed, retrying\",Toast.LENGTH_SHORT).show();<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â new Thread() {<br><br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â public void run() {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  try {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â socket = new Socket(HOST, PORT);<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â in = new BufferedReader(new InputStreamReader(socket.getInputStream(), \"UTF-8\"));<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â out = new PrintWriter(new BufferedWriter(new OutputStreamWriter(<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  socket.getOutputStream())), true);<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  } catch (IOException e) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â e.printStackTrace();<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  }<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â }.start();<br>Â  Â Â  Â Â  Â Â  Â Â  Â  }<br>Â  Â Â  Â Â  Â Â  Â Â  Â  else<br>Â  Â Â  Â Â  Â Â  Â Â  Â  {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â if (socket.isConnected()) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â if (!socket.isOutputShutdown()) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  out.println(msg);<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â }<br>Â  Â Â  Â Â  Â Â  Â Â  Â  }<br>Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â Â });<br>Â  Â Â  Â Â Â new Thread(MainActivity.this).start();<br>Â  Â  }<br><br>Â  Â  //é‡å†™runæ–¹æ³•,åœ¨è¯¥æ–¹æ³•ä¸­è¾“å…¥æµçš„è¯»å–<br>Â  Â  @Override<br>Â  Â  public void run() {<br>Â  Â Â  Â Â Â try {<br>Â  Â Â  Â Â  Â Â  Â while (true) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â  if (socket.isConnected()) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â if (!socket.isInputShutdown()) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â if ((content = in.readLine()) != null) {<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  content += \"\\n\";<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â  handler.sendEmptyMessage(0x123);<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â  Â Â  Â Â  Â Â  Â Â Â }<br>Â  Â Â  Â Â  Â Â  Â Â  Â  }<br>Â  Â Â  Â Â  Â Â  Â }<br>Â  Â Â  Â Â Â } catch (Exception e) {<br>Â  Â Â  Â Â  Â Â  Â e.printStackTrace();<br>Â  Â Â  Â Â Â }<br>Â  Â  }<br>}<br></pre></div> ","time":"2017-10-12 13:10","title":"æ–°æ‰‹å†™ä¸€ä¸ªå®‰å“appï¼Œç”¨ä»€ä¹ˆæ ·çš„æ–¹æ³•å’ŒæœåŠ¡å™¨é€šä¿¡æ¯”è¾ƒå¥½ï¼Ÿ","userId":"misakaxindex","userName":"æ±ç€¬ã¾ã¤ã‚Šå¤ª ğŸ¦‹â„ï¸ğŸ»ğŸ’â¤ï¸ğŸ¥•","userSign":"([s]å®‰é™ç‚¹æ ¼å­[/s])"}
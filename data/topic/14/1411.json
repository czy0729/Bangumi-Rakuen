{"id":1411,"avatar":"//lain.bgm.tv/pic/user/m/000/00/71/7134.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"都在比蛋痛来着...<br>昨天看了下http抓包分析的文章...把bangumi试试了..ok...<br>实现发送bangumi吐槽内容= =<br><br>#include <stdio.h>   <br>#include <winsock2.h>      <br>#define SIZE 122<br>void ma(char* host_name,char* req);<br>int main(int argc, char* argv[])   <br>{   <br>    char*   host_name=\"www.******.tv\";   <br>    char   req[]=   <br>  \"POST /update/user/say HTTP/1.1\\r\\n\"<br>  \"Accept:   image/gif, image/jpeg, image/pjpeg, image/pjpeg, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, application/x-shockwave-flash, */*\\r\\n\"<br>  \"Referer:   <a href=\"http://*******/timeline\\r\\n\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://*******/timeline\\r\\n</a>\"<br>  \"Referer:   <a href=\"http://*******/timeline\\r\\n\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://*******/timeline\\r\\n</a>\"<br>  \"Accept-Language:   zh-cn\\r\\n\"<br>  \"User-Agent:   Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.2; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)\\r\\n\"<br>  \"Content-Type:   application/x-www-form-urlencoded\\r\\n\"<br>  \"Accept-Encoding:   gzip, deflate\\r\\n\"<br>  \"Host:   *******\\r\\n\"<br>  \"Content-Length:   16\\r\\n\"<br>  \"Connection:   Keep-Alive\\r\\n\"<br>  \"Cache-Control:   no-cache\\r\\n\"<br>  \"Cookie:   chii_sid=74sZYR; __utma=246690711.1848890882.1262093557.1262093557.1262093557.1; __utmb=246690711.5.10.1262093557; __utmc=246690711; __utmz=246690711.1262093557.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); chii_cookietime=0; chii_auth=Ae29Qo8ojf4Y5NnfKRRYuRCUNDuAA9eiQKj5zjZpEoKu8gg4T7fqU7u6mtCR\\r\\n\\r\\n\"<br>  \"say_input=\";<br>    // 初始化套接字<br>        int i=0;  <br>    char input[SIZE];<br>    char temp;<br>    char number[]=\" 1016\";<br>    char *x;<br>      while (SIZE!=i)<br>    {<br>            temp=getchar();<br>            if(temp==' ')<br>                    continue;<br>                   if(temp=='\\n')<br>                           break;<br>            input<span style=\"font-style:italic\">=temp;<br>                i++;<br>        }<br>        strcat(req,input);<br>        strcat(req,number);<br>        x=req;<br>        ma(host_name,x);<br>    return 0;   <br>} <br><br>void ma(char* host_name,char* req)<br>{<br>        SOCKADDR_IN saServer;   <br>    LPHOSTENT   lphostent;   <br>    WSADATA     wsadata;   <br>    SOCKET      hsocket;   <br>    int     nRet;   <br>    if(WSAStartup(MAKEWORD(2,2),&wsadata))      <br>        printf(\"初始化SOCKET出错！\");   <br>  <br>    lphostent=gethostbyname(host_name);      <br>    if(lphostent==NULL)      <br>        printf(\"lphostent为空！\");   <br>    hsocket   =   socket(AF_INET,SOCK_STREAM,IPPROTO_TCP);      <br>    saServer.sin_family = AF_INET;      <br>    saServer.sin_port = htons(80);      <br>    saServer.sin_addr = *((LPIN_ADDR)*lphostent->h_addr_list);   <br>    nRet = connect(hsocket,(LPSOCKADDR)&saServer,sizeof(SOCKADDR_IN));      <br>    if(nRet == SOCKET_ERROR)      <br>    {      <br>        printf(\"建立连接时出错！\");      <br>        closesocket(hsocket);      <br>        return ;      <br>    }   <br>          else <br>          {<br>          printf(\"成功\");<br>          } <br>    nRet = send(hsocket,req,strlen(req),0);   <br>    if(nRet==SOCKET_ERROR)   <br>    {   <br>        printf(\"发送数据包时出错！\");   <br>        closesocket(hsocket);   <br>    }   <br>  <br>    char   Dest[3000];      <br>    nRet=1;      <br>    while(nRet>0)      <br>    {      <br>        nRet=recv(hsocket,(LPSTR)Dest,sizeof(Dest),0);      <br>        if(nRet>0)      <br>            Dest[nRet]=0;      <br>        else      <br>            Dest[0]=0;   <br>        printf(\"\\nReceived   bytes:%d\\n\",nRet);      <br>        printf(\"Result:\\n%s\\n\",Dest);      <br>    }   <br>    return ;   <br>} <br><br>明白人都知道******填什么 </span>","time":"2009-12-30 10:54","title":"吐槽dos发送器= =","userId":"7134","userName":"sofitte","userSign":""}
{"id":371349,"avatar":"//lain.bgm.tv/pic/user/m/000/13/14/131492.jpg","floor":"#1","group":"番组开发","groupHref":"/group/dev","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/41/4180.jpg?r=1519373244","message":"更新：组件审核通过啦：<a href=\"https://bgm.tv/dev/app/2360\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://bgm.tv/dev/app/2360</a><br><br>标题有点绕，就是显示在看或者看过是什么时候点的<br><br>效果：<br><img src=\"http://azusebox.moe/wp-content/uploads/2022/07/20220706-171736.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>使用openapi：api.bgm.tv/v0/users/{}/collections/{}<br>刚刚花了二十分钟写的，正在提交合金组件申请，可以先测试下<br><span style=\"font-style:italic\"><span style=\"font-weight:bold;\">对于私密收藏没有效果</span></span><br>说实话openapi的token认证对脚本不是太友好，可以支持下用主站的cookie认证嘛。。<br><br>源码二十行：<br><div class=\"codeHighlight\"><pre><br>// ==UserScript==<br>// Add Time to Subject Display<br>// @version      0.1<br>// @description  try to take over the world!<br>// @author       misakaxindex<br>// @match        https://bangumi.tv/subject/*<br>// @match        https://bgm.tv/subject/*<br>// @icon         https://www.google.com/s2/favicons?sz=64&domain=bangumi.tv<br>// ==/UserScript==<br><br>(function() {<br>    'use strict';<br>    function GetUserCollectionTime(user_id, subject_id) {<br>        let uri = 'https://api.bgm.tv/v0/users/'+user_id+'/collections/'+subject_id<br>        $.ajax({<br>                type: \"GET\",<br>                url: uri,<br>                success: function (data) {<br>                    let html = document.createElement('span');<br>                    html.innerText = data.updated_at.split('T')[0]<br>                    html.style = \"color:gray\"<br>                    let target = $('div.SidePanel hr.board')[0]<br>                    target.parentNode.insertBefore(html, target);<br>                    console.log(html)<br>                    chiiLib.tml.prepareAjax();<br>                },<br>                error: function (html) {<br>                    $(\"#robot_speech_js\").html(AJAXtip['error']);<br>                    $(\"#robot\").animate({<br>                        opacity: 1<br>                    }, 1000).fadeOut(500);<br>                }<br>            });<br><br>    }<br><br>    let url = window.location.href<br>    let subject_id = url.split('/subject/')[1]<br>    let user_id = $('a.avatar')[0].href.split('/user/')[1]<br>    GetUserCollectionTime(user_id, subject_id)<br>})();<br></pre></div> ","time":"2022-7-6 17:20","title":"[组件]在收藏页面(/subject)显示用户创建收藏的时间","userId":"misakaxindex","userName":"東瀬まつり🦋❄️🐻💎🐺🍎🐠","userSign":"([s]安静点格子[/s] ☄️⚓ ☁️⭐️)"}
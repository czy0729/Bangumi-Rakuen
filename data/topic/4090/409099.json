{"id":409099,"avatar":"//lain.bgm.tv/pic/user/m/000/75/22/752263.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"众所周知班固米首页【在看】的番剧，点击标题和封面都能进入详情，<span style=\"text-decoration: line-through;\">为了防止资源浪费</span>我写了个简陋的脚本，当点击标题，也就是div class=\"tinyHeader\"的时候，直接跳转到nyaa的搜索页面，而不是番剧详情页。<br>但是有个问题，我是直接选取data-subject-name的前四个字符作为关键词搜索的，遇到“チ。 ―地球の運動について―”这种名字的时候会简单粗暴的取成“チ。 ―地”，根本搜不出来<img src=\"/img/smiles/tv/16.gif\" smileid=\"55\" alt=\"(bgm39)\"><br>急求一个高智商版本的思路，附上我的脚本代码<br><div class=\"codeHighlight\"><pre><br>// ==UserScript==<br>//略<br>// @match        https://bangumi.tv/<br>// ==/UserScript==<br><br>(function() {<br>    'use strict';<br><br>    document.addEventListener('click', function(e) {<br>        if (e.target.closest('.tinyHeader')) {<br>            // 获取 data-subject-name<br>            const tinyHeader = e.target.closest('.tinyHeader');<br>            const subjectName = tinyHeader.querySelector('[data-subject-name]')?.getAttribute('data-subject-name');<br><br>            if (subjectName) {<br>                const keyword = subjectName.slice(0, 4);<br>                const searchUrl = `https://nyaa.si/?f=0&c=0_0&q=${encodeURIComponent(keyword)}`;<br><br>                // 替换 href<br>                const links = tinyHeader.querySelectorAll('a');<br>                links.forEach(link => {<br>                    link.setAttribute('href', searchUrl);<br>                });<br><br>                // 阻止跳转<br>                e.preventDefault();<br>                window.open(searchUrl, '_blank');<br>            }<br>        }<br>    });<br>})();<br></pre></div>","time":"2024-11-7 09:18","title":"思路求助，首页点击标题直接链接到资源站","userId":"shironegi","userName":"白葱","userSign":"(要和蒜末一起炒)"}
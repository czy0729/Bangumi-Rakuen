{"id":350626,"avatar":"//lain.bgm.tv/pic/user/m/000/28/76/287622.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"懒得提交到greakfork之类的市场了，代码也没几行<br>网站本来的行为是要有点击才会检查新通知，但我想放在后台的时候也可以看到通知,同时可以通过标签栏上面的标题知道有几条通知<br><br>本来还想写一个组件的，但是相比而言用用户脚本简单一点，而且我基本都是在桌面端使用，所以就只写了一个用户脚本<br><br><div class=\"codeHighlight\"><pre>// ==UserScript==<br>// @name        bgm.tv desktop notify<br>// @match     https://bgm.tv/*<br>// @grant       GM_notification<br>// @grant       window.focus<br>// @icon           https://bgm.tv/img/favicon.ico<br>// @noframes<br>// ==/UserScript==<br><br>var docTitle = document.title;<br><br>setInterval(() => {<br>    console.log('check notify')<br>    $.get('/json/notify?_=' + Date.now()).then(res => {<br>        res = JSON.parse(res)<br>        if (res.count !== '0') {<br>            document.title = \"(\" + res.count + \") \" + docTitle;<br>            GM_notification({<br>                text: 'bgm.tv new notify',<br>                title: 'bgm.tv new notify',<br>                timeout: 15000,<br>                onclick: function () { window.focus(); },<br>            });<br>        } else {<br>            document.title = docTitle;<br>        }<br>    })<br>}, 5000);<br><br></pre></div> ","time":"2019-5-8 02:40","title":"用户脚本，bgm新消息的桌面通知","userId":"trim21","userName":"Trim21","userSign":"(<img src=\"#\" ></img>)"}
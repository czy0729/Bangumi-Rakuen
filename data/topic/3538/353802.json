{"id":353802,"avatar":"//lain.bgm.tv/pic/user/m/000/28/37/283739.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"UPDATE:在 Hentyclopedia 和 烈之斩 的提示下,我更新了代码.<br><br>================================<br><br>一开始是听群友提到他尝试用Aria2的BT下载,然后手动从<a href=\"https://github.com/ngosang/trackerslist\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">ngosang/trackerslist</a>复制粘贴Trackers列表.<br>我虽然之前早就知道有这么个项目,但也只是star后就没怎么关注了...<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br>我问为什么用Aria2下载BT资源,不用qBittorrent之类的,然后他说不知道出什么问题用不了.<br>有其他群友对qBittorrent感兴趣,想了解下怎么用,于是我搜索文章想安利一下,刚好发现<a href=\"https://github.com/copyshiroe/MyUsefulScripts/blob/master/win/update_trackers_to_qbittorrent_setting.ps1\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">一个网友写的给qBittorrent更新Trackers列表的PowerShell脚本</a>.<br>对于PowerShell,我没什么了解也没什么兴趣,虽然差不多能看懂,但我还是拿Python照著大致相同的思路撸了一个.<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br>然后顺便稍微改一下弄了个Aria2的,大部分代码都是一样的,也就是更新配置文件的部分不一样.<br><br>需要注意的3点:<br><br>* 脚本用到了这些模块:os/requests/re/configparser,如果运行报错提示缺少就用pip install安装<br>* Aria2的脚本中,变量configFilePath需要改为你的Aria2配置文件所在路径<br>* 脚本成功运行后,因为配置文件改变,需要关闭程序重启来使其生效<br><br>qBittorrent:<br><div class=\"codeHighlight\"><pre><br># 更新 bt-tracker 到 qBittorrent<br>import os<br>import requests<br>import re<br>import configparser<br><br># 下载trackerslist<br>baseUrl = \"https://raw.githubusercontent.com/ngosang/trackerslist/master/\"<br>url1 = baseUrl + \"trackers_all.txt\"<br>url2 = baseUrl + \"trackers_all_ip.txt\"<br>trackers = requests.get(url1).content.decode()<br>trackers += requests.get(url2).content.decode()<br><br># 去除空行和重复行,然后合并为一行<br>trackersList = trackers.strip().split(\"\\n\\n\")<br>trackersList = list(set(trackersList))<br>trackers = r\"\\n\".join(trackersList)<br><br># 更新到 %APPDATA%\\qBittorrent\\qBittorrent.ini<br>configFilePath = os.getenv(\"APPDATA\") + \"\\qBittorrent\\qBittorrent.ini\"<br>os.system(\"COPY {} {}\".format(configFilePath, configFilePath + \".old\"))<br>config = configparser.ConfigParser()<br>config.optionxform = str<br>config.read(configFilePath)<br>config.set(\"Preferences\", \"Bittorrent\\TrackersList\", trackers)<br>with open(configFilePath, \"w\") as configFile:<br>    config.write(configFile)<br></pre></div><br><br>Aria2:<br><div class=\"codeHighlight\"><pre><br># 更新 bt-tracker 到 Aria2<br>import os<br>import requests<br>import re<br><br># 下载trackerslist<br>baseUrl = \"https://raw.githubusercontent.com/ngosang/trackerslist/master/\"<br>url1 = baseUrl + \"trackers_all.txt\"<br>url2 = baseUrl + \"trackers_all_ip.txt\"<br>trackers = requests.get(url1).content.decode()<br>trackers += requests.get(url2).content.decode()<br><br># 去除空行和重复行,然后合并为一行<br>trackersList = trackers.strip().split(\"\\n\\n\")<br>trackersList = list(set(trackersList))<br>trackers = \"bt-tracker=\" + \",\".join(trackersList)<br><br># 更新到 \"aria2.conf\"<br>configFilePath = r\"E:\\MyPortableApplications\\Aria2\\aria2.conf\"<br>os.system(\"COPY {} {}\".format(configFilePath, configFilePath + \".old\"))<br>with open(configFilePath, \"r+\", encoding=\"utf-8\") as configFile:<br>    oldConfig = configFile.read()<br>    newConfig = re.sub(\"bt-tracker=.*\", trackers, oldConfig)<br>    configFile.seek(0)<br>    configFile.write(newConfig)<br></pre></div> ","time":"2019-12-11 09:02","title":"心血来潮撸了用来更新Trackers列表的Python脚本","userId":"neko_aria","userName":"𝒩𝑒𝓀𝑜_𝒜𝓇𝒾𝒶","userSign":"(ᓚᘏᗢ_(:3」∠)_翼酱です～银发红瞳赛高！ ...)"}
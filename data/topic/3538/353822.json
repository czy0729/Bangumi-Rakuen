{"id":353822,"avatar":"//lain.bgm.tv/pic/user/m/000/43/16/431650.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"<a href=\"https://p.sda1.dev\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://p.sda1.dev</a><br><br>上周听说sm.ms推出了付费服务，不禁想到了一个问题，如果我们只有每月几刀的很低的预算，并且希望用它支持一个图床项目，我们究竟能保证多高的可用性和存续性。<br><br>上面这个网址是我花了三四天时间做的一个原型，经过一天多紧张的debug，看起来已经没有太明显的问题了。它的特点有：<br>* 最底下用大家相对来说已经摸清脾气的大容量网盘存储。具体来说用的是Google Drive，所有数据都加密后存储在gd，并且不使用外链等可能触碰gd神经的操作。所有图片数据和metadata可以容易地全站备份（放到其他gd账号或者别家网盘）。<br>* 找一家比较靠谱的FaaS服务商，在上面实现一套图床的基本api。这里选择的是付费版（月付5usd）的Cloudflare workers，主要的原因是流量不计费，并且有比较充裕的key-value存储quota，此外可以操作cf本身的CDN cache，合起来可以实现令人满意的cache，避免掉绝大多数回源的gd api操作。即使要回源，也只需要一次gd api操作就可以取到图片。墙外访问不太感知得出回源带来的延迟。<br>* web前端比较简单（其实是直接抄的sm.ms，可以看到about页面之类的通通都还没有做）。所有静态资源放在github pages。<br><br>这个方案最大的风险可能还是在于如果完全放置，被用来外链一些敏感内容的话，有整个域名被墙掉的风险。除开这一点，永久储存所有图片，在这样的月供下至少运行个三五年看起来不是什么天方夜谭..<br><br>放个测试图，大约2.5M<br><img src=\"https://p.sda1.dev/0/f6820a455350c32a17a4c292f2b8242a/IMG_20191121_163618.jpg\" class=\"code\" alt> ","time":"2019-12-12 12:37","title":"一个非典型公益图床项目","userId":"fotile96","userName":"诚信肥肥","userSign":"(命揺らせ 命揺らせ)"}
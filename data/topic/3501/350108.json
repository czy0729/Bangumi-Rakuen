{"id":350108,"avatar":"//lain.bgm.tv/pic/user/m/000/31/05/310594.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"前一阵在知乎上好像看过一个评价王思聪主机配置的问题，一下找不到了，在这里重建一下。<br><br>从计算架构的角度来看，游戏机涉及的组件主要是：CPU，显卡，内存，存储，输入外设（键盘，鼠标），输出外设（显示器，音响）。<br><br>这里面最好选的是显卡，因为事实上只有一家，上到美国国防部下到网吧店主都得用他。<br><br>显卡评价主要有几个指标：像素填充率（图形计算，每秒可以画多少像素，我们不做数值计算），显存大小（可以在显卡上存多少材质），内存带宽+总线接口（显卡上存不下的时候，从主存经过PCIe总线DMA进来材质，有多快（NVLink 2.0也可以连CPU，而且比PCIe 3.0快许多倍，然而CPU只支持POWER9，而且用途是给美国能源部算核弹））。从这里选择：<a href=\"https://en.wikipedia.org/wiki/List_of_Nvidia_graphics_processing_units\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://en.wikipedia.org/wiki/Li ... cs_processing_units</a><br><br>我们选择：Nvidia TITAN RTX，填充率130 GP/s，内存24GB，接口PCIe 3.0 x16，内存带宽672 GB/s。<br><br>其实王思聪配置有一个bug：Nvidia GTX 980这个显卡是PCIe x16的总线接口，而Intel 5960X只支持40路PCIe，所以4x GTX 980的时候至少有一个显卡是废掉的，还有一个显卡是半残。这里就可以看出PCIe路数是一个瓶颈。<br><br>显卡往外接显示器，往内接CPU。接下来，比较容易选的是显示器。连接显示器一般有两种标准，DisplayPort和HDMI。HDMI 2.1比最新的DisplayPort快了不少，但是TITAN RTX还不支持。DisplayPort支持的制式见这里：<a href=\"https://en.wikipedia.org/wiki/DisplayPort#Resolution_and_refresh_frequency_limits\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://en.wikipedia.org/wiki/Di ... sh_frequency_limits</a> 。这里又是一个显示器厂家的瓶颈，Display 1.4的DSC数据压缩，不会弄。所以现在的选择就是4K 120Hz或者1440p 240Hz。这两种模式都在大约25Gbps的传输速率，或者1GP/s。所以GPU画像素的速度比显示器显示像素的速度快多了，多GPU实属多此一举。除非...王思聪要实时计算合成孔径雷达图像。<br><br>那么选择4K 144Hz G-Sync，仅有Asus PG27UQ。<br><br>往内接CPU，主要看PCIe路数，也就是一颗CPU能插几片显卡的问题。Intel自Skylake之后都是48路，也就是一颗CPU插三片显卡。AMD EPYC 7000系列一颗CPU支持128路，理论上能插8片GPU。所以连主板一起选了：Gigabyte G291-Z20。Intel对此的答案是“Xeon Scalable”，用多个CPU把更多的显卡支持住。但是这样的问题是可以无限地scale up，到某个程度就超出了一个人能使用的范围，变成了云主机。所以其实一个人能使用的计算资源还是有限的。<br><br>Gigabyte G291-Z20的报价在这里：<a href=\"https://www.gamepc.com/shop/products?sku=6NG291Z20MR-00\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://www.gamepc.com/shop/products?sku=6NG291Z20MR-00</a>。其实看这个同类产品（基于Intel的）<a href=\"https://www.gamepc.com/shop/systemfamily?family=ds5\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://www.gamepc.com/shop/systemfamily?family=ds5</a> 大概就知道最后结果了（8x Nvidia Tesla V100，等等，报价$88K）。<br><br>另外一个问题是，到某个时候由于一个人使用的空间有限，存储的媒介可能不是特别重要。例如Gigabyte G291-Z20支持2TB内存，开机后把所有内容都挪到内存映射驱动器里，那存储具体是什么就不重要了。<br><br>如果需要比如2TB以上的存储，我们还是可以考虑RDMA over InfiniBand接到旁边一套机器上专门装内存，例如。不乱搞正经一点的话，可以考虑NVMe over InfiniBand的解决方案，见：<a href=\"http://www.mellanox.com/blog/2017/11/nvme-fabrics-infiniband-worlds-fastest-storage-network/\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://www.mellanox.com/blog/201 ... st-storage-network/</a>，即NetApp E5700系列（低配版E5724，网上竟然没找到报价，可能原因是报价有一半是企业支持的价格；在一个政府采购网上找到指导价是$60K）。<br><br>音响由于涉及到玄学，不太好讨论。键盘鼠标具体什么型号不重要，重要的是能不能不走USB，因为USB延迟太高了（毫秒级）。我估计市面上没有，但是可以找一个EE来做一个接InfiniBand的键盘鼠标的控制器（低于一微秒）。大概需要一人年，算$100K。<br><br>我已经不想考虑网卡了。网卡也有Mellanox做的100GbE解决方案，都是解决方案，都有报价的问题。网络的问题关键在于再贵的网卡你还是接到中国电信100块钱的路由器上。如果要打网游的话，可以类比HFT，接微波专线直接接到机房，参考<a href=\"https://arstechnica.com/information-technology/2016/11/private-microwave-networks-financial-hft/\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://arstechnica.com/informat ... orks-financial-hft/</a>。<br><br>总的算下来，本机的报价大概在$200K~$300K（120w到240w人民币）。建微波专线涉及到组技术团队，卖地皮，卖频段，政府公关审批，不在一个数量级，可能无法估计。<br><br>感谢观看。 ","time":"2019-4-6 05:28","title":"如果你有无限预算可以配置出怎样的主机？","userId":"tmpfs","userName":"​","userSign":""}
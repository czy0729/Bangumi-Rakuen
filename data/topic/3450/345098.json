{"avatar":"//lain.bgm.tv/pic/user/m/000/31/65/316509.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"rt，因为我经常会收集好几个字幕组的字幕，然后看的时候如果要一个一个手动改名字加载的话很烦，所以就写了个脚本把字幕文件改成和视频一样的格式，也就是说，这个脚本会保留集数编号和所有拓展名，把剩下的东西改成和视频文件一样的格式<br>脚本会读三个字符串参数，第一个是新文件的文件名格式（必填），第二个是要被重命名的文件的格式（默认\".ass\")，第三个是用来寻找集数的正则表达式，第三个参数默认就是查找方括号里的两个数字。<br>例如，我dir装字幕的文件夹<br><div class=\"codeHighlight\"><pre><br>[YYDM-11FANS][Fate_Stay_Night][01][BDRIP][720P][X264-10bit_AAC][F7D2EC97].sc.ssa<br>[YYDM-11FANS][Fate_Stay_Night][01][BDRIP][720P][X264-10bit_AAC][F7D2EC97].tc.ssa<br>[YYDM-11FANS][Fate_Stay_Night][02][BDRIP][720P][X264-10bit_AAC][4EC1A967].sc.ssa<br>[YYDM-11FANS][Fate_Stay_Night][02][BDRIP][720P][X264-10bit_AAC][4EC1A967].tc.ssa<br>...<br></pre></div><br>而我的视频文件却长得不一样：<br><div class=\"codeHighlight\"><pre><br>[VCB-Studio] Nichijou [01] [Ma10p_1080p][x265_flac_aac].mp4<br>[VCB-Studio] Nichijou [02] [Ma10p_1080p][x265_flac_aac].mp4<br>...<br></pre></div><br>就到字幕的目录下运行：<br><div class=\"codeHighlight\"><pre><br>脚本名.ps1 \"[VCB-Studio] Nichijou [01] [Ma10p_1080p][x265_flac_aac].mkv\"  \"YYDM\" \"\\[\\d{2}\\]\"<br></pre></div><br>然后输yes，<br>结果就是这样：<br><div class=\"codeHighlight\"><pre><br>[VCB-Studio] Nichijou [01] [Ma10p_1080p][x265_flac_aac].sc.ssa<br>[VCB-Studio] Nichijou [01] [Ma10p_1080p][x265_flac_aac].tc.ssa<br>[VCB-Studio] Nichijou [02] [Ma10p_1080p][x265_flac_aac].sc.ssa<br>[VCB-Studio] Nichijou [02] [Ma10p_1080p][x265_flac_aac].tc.ssa<br>...<br></pre></div><br>第一个就是任意一个视频文件的文件名，第二个参数只要能够用来识别要被重命名的字幕文件就可以了<br>重命名后的文件会在当前目录下的\"renamed\"文件夹内<br>如果参数传失败之类的情况的话，也可以直接修改脚本里面$match，$newFormat和$epRegex变量<br>这个脚本需要windows系统powershell，没有运行过ps脚本的大概要先解锁运行权限<br><br>这么low的东西，如果有人会觉得有用就好了<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br><br>代码如下：<a href=\"https://github.com/Rivers47/miscellaneous/blob/master/autoRename.ps1\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">github</a>也有<br><div class=\"codeHighlight\"><pre><br>Param(<br>    [string]$newFormat,<br>    [string]$match,<br>    [string]$epRegex<br>)<br><br>#$newFormat = \"[VCB-Studio] Nichijou [01] [Ma10p_1080p][x265_flac_aac].mp4\"<br>if(-Not $newFormat) <br>{<br>    Write-Error \"I don't know what format should I follow\"<br>    exit<br>}<br>if(-Not $match) {$match = \".ass\"}<br>if(-Not $epRegex) {$epRegex = \"\\[\\d{2}\\]\"}<br>write-host \"The new naming format is according to: `\"$newFormat`\"\"<br>write-host \"Files contain `\"$match`\" will be renamed\"<br>write-host \"The episode format is: `\"$epRegex`\"\"<br><br>$confirm = Read-Host -Prompt 'Do you wish to continue?(Y/N)'<br><br>if($confirm -match \"[Yy]\")`<br>{ <br>    $match = \"*\" + $match + \"*\"<br>    $select = $newFormat | Select-String -Pattern \".*(?=$epRegex)\" -Encoding utf8<br>    $newName1 = $select.Matches.GetValue(0).ToString()<br><br>    $select = $newFormat | Select-String -Pattern \"(?<=$epRegex)[^\\.]*\" -Encoding utf8<br>    $newName2 = $select.Matches.GetValue(0).ToString()<br><br>    #$i = 1<br><br>    $tempFolder = \"AUTORENAMETEMP\"<br>    New-Item -Path . -Name \"renamed\" -ItemType \"directory\" -ErrorAction SilentlyContinue<br>    New-Item -Path . -Name \"$tempFolder\" -ItemType \"directory\" -ErrorAction SilentlyContinue<br>    Copy-Item -Path .\\* -Filter $match -Destination .\\$tempFolder<br><br>    Get-ChildItem -Filter \"*$match*\" |<br>    ForEach-Object `<br>    {<br>        #$_.Name<br><br>        $select = $_.Name | Select-String -Pattern \"$epRegex\" -Encoding utf8<br>        $epn = $select.Matches.GetValue(0).ToString()<br>        #$epn<br>        $select = $_.Name | Select-String -Pattern \"(\\.\\w+)+\" -Encoding utf8<br>        $extension = $select.Matches.GetValue(0).ToString()<br>        #$extension<br><br>        $finalNewName = $newName1 + $epn + $newName2 + $extension<br>        #$finalNewName<br><br>        #$i++<br>        #Rename-Item -LiteralPath $_.FullName -NewName $newName<br>        move-Item -LiteralPath $_.FullName -Destination \".\\renamed\\$finalnewName\"<br>    }<br>    Move-Item -path .\\$tempFolder\\* -Destination \".\\\"<br>    Remove-Item -Path .\\$tempFolder -Recurse<br>}<br><br><br>#$newName = '{0:d2}{1}' -f $i, $extension<br></pre></div><br>天呐大佬们都知道这么多强大的软件<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"> ","time":"2018-2-19 08:13","title":"一个非常lowb的用来给字幕重命名的ps脚本","userId":"316509","userName":"Rivers","userSign":"(Don't feel. Think.)"}
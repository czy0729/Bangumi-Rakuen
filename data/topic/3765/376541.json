{"id":376541,"avatar":"//lain.bgm.tv/pic/user/m/000/17/18/171851.jpg","floor":"#1","group":"番组开发","groupHref":"/group/dev","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/41/4180.jpg?r=1519373244","message":"因为无意中刷到循环定时发送请求的方法 于是趁热打铁把这<a href=\"https://github.com/bangumi/scripts/tree/master/yonjar#用户详情爬取\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">脚本</a>以前并发过快炸班固米的bug修了 现在几十页收藏也能顺利爬取下来啦<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br>即使是3022年也希望新增能直接获取用户[收藏的人物角色]&[好友]信息的api<img src=\"/img/smiles/tv/16.gif\" smileid=\"55\" alt=\"(bgm39)\"><br><img src=\"//lain.bgm.tv/pic/photo/l/dc/a1/171851_1FoZy.jpg\" class=\"code\" alt><br><br>下面是借用到的代码片段<span style=\"background-color:#555;color:#555;border:1px solid #555;\">(好用)</span> 解决了请求并发问题后能搞得东西就多了,,,<br><div class=\"codeHighlight\"><pre>// 我们可以把 setTimeout 封装成一个 Promise，然后再在 for 循环里使用。<br><br>const sleep = (delay) => {<br>  return new Promise((resolve) => setTimeout(resolve, delay));<br>};<br><br>// 循环所在的函数改为async-await的结构：<br>const start = async () => {<br>  for (var i = 0; i < 10; i++) {<br>    // for-of也可以<br>    await sleep(500);<br>    console.log(i);<br>  }<br>};<br>start();</pre></div><div class=\"quote\"><q>在 JavaScript 中循环和定时输出一系列的内容-蚊子-前端博客<br>https://www.xiabingbao.com/post/fe/loop-settimeout-rg18mv.html</q></div> ","time":"2023-1-9 00:24","title":"[脚本&api更新希望]坑了n年的脚本user detail复活","userId":"yonjar","userName":"頂上の月🌙","userSign":"(bangumi知名dd)"}
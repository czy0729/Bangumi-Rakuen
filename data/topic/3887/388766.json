{"id":388766,"avatar":"//lain.bgm.tv/pic/user/m/000/40/90/409035.jpg","floor":"#1","group":"靠谱人生茶话会","groupHref":"/group/boring","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/03/364.jpg","message":"10/23更新，对恢复原名的样式进行了更新，优化了显示问题，现在译名为单独一行显示，进度卡片隐藏显示<br><br>------------------------------------------------------------------------<br><br><span style=\"text-decoration: line-through;\">既然sai姐没有改的意思那就只好自己动手了，提供了两个组件</span>，sai姐似乎改了……部分<img src=\"/img/smiles/tv/16.gif\" smileid=\"55\" alt=\"(bgm39)\"><br><br>为了显得今晚不是那么傻逼，<span style=\"text-decoration: line-through;\">总感觉更傻逼了</span>，紧急追加了第三个组件，将条目恢复原名，中文名小字显示<br><br><a href=\"https://bgm.tv/dev/app/2806\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">时间线卡片调整：移除标记进度卡片</a><br><a href=\"https://bgm.tv/dev/app/2805\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">时间线卡片调整：移除评分&排名</a><br><a href=\"https://bgm.tv/dev/app/2807\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">时间线卡片调整：条目名恢复原名</a><br><br>已经通过审核<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br><br>其中移除卡片的组件，因为原有条目标记右侧的封面已经没有了，因此没有移除条目标记的卡片（其实是不会加）<br><br>感谢<a href=\"/user/alneys\" class=\"l\">@Alneys</a>提供了移除元素的核心代码<span style=\"text-decoration: line-through;\">误</span><img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br><br>代码放在这里内容太多了，我移到了GitHub，有兴趣可以查看 <a href=\"https://github.com/bangumi/scripts/tree/master/eien\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://github.com/bangumi/scripts/tree/master/eien</a><br><br>js很垃圾，大佬轻喷<br><br>------------------------------------------------------------------------<br><br>条目名恢复原名新版还没过审核，这里也放一下，过审后这部分会删掉<br><br>这部分较为复杂，如果使用自用的插件，请将下面两个部分分别填入脚本和样式区域<br><br>脚本：<br><div class=\"codeHighlight\"><pre>// == UserScript ==<br>// @name         修改卡片标题和副标题<br>// @namespace    https://bgm.tv/group/topic/388766<br>// @version      0.2<br>// @description  交换所有 .card 元素中的 .title 和 .subtitle 文本<br>// @author       默沨<br>// @match        https://bangumi.tv/<br>// @match        https://bgm.tv/<br>// @match        https://chii.in/<br>// @icon         https://bgm.tv/img/favicon.ico<br>// @grant        none<br>// ==/UserScript==<br><br>(function () {<br>    'use strict';<br><br>    function swapTitlesAndSubtitles() {<br>        // 获取页面上所有具有 \"card\" 类的元素<br>        const cardElements = document.querySelectorAll('.card:not([data-swapped])');  // 只选择还未处理过的.card元素<br><br>        // 遍历每一个 \"card\" 元素<br>        cardElements.forEach((card) => {<br>            // 找到该 card 内部的 .title 和 .subtitle 元素<br>            const titleElement = card.querySelector('.title');<br>            const subtitleElement = titleElement.querySelector('.subtitle');<br><br>            if (titleElement && subtitleElement) { // 确保两者都存在<br>                // 获取它们的文本内容<br>                const fullTitleText = titleElement.textContent.trim();<br>                const subtitleText = subtitleElement.textContent.trim();<br><br>                if (subtitleText === '') {<br>                    card.setAttribute('data-swapped', 'true');  // 标记该.card元素已经被处理过<br>                } else {<br>                    const pureTitleText = fullTitleText.replace(subtitleText, '').trim();<br><br>                    // 重新组合.title和.subtitle<br>                    titleElement.innerHTML = `${subtitleText} <small class=\"grey\">${pureTitleText}</small>`;<br><br>                    card.setAttribute('data-swapped', 'true');  // 标记该.card元素已经被处理过<br>                }<br>            }<br>        });<br>    }<br><br>    // 首次运行<br>    swapTitlesAndSubtitles();<br><br>    // 创建一个观察器实例<br>    const observer = new MutationObserver(function (mutations) {<br>        swapTitlesAndSubtitles();<br>    });<br><br>    // 配置观察器：观察整个文档和子树的变化<br>    observer.observe(document.body, { childList: true, subtree: true });<br>})();</pre></div><br><br>样式：<br><div class=\"codeHighlight\"><pre>#timeline ul li .card .inner .title small.grey {<br>    display: block;<br>}<br>#timeline ul li .card.card_tiny .inner .title small.grey {<br>    display: none;<br>}<br>#timeline ul li .card.card_tiny:hover .inner .title small.grey {<br>    display: inline;<br>}<br>#timeline ul li .card.card_tiny:hover .inner .title small.grey {<br>    display: block;<br>}<br>#timeline ul li.tml_item .card.card_tiny {<br>    max-height: unset;<br>}<br>#timeline ul li.tml_item .card.card_tiny .info {<br>    display: none;<br>}<br>#timeline ul li.tml_item .card.card_tiny:hover .info {<br>    display: block;<br>}</pre></div><br><br>或者将下面的代码全部插入脚本区，不要填写样式<br><div class=\"codeHighlight\"><pre>// == UserScript ==<br>// @name         修改卡片标题和副标题<br>// @namespace    https://bgm.tv/group/topic/388766<br>// @version      0.2<br>// @description  交换所有 .card 元素中的 .title 和 .subtitle 文本<br>// @author       默沨<br>// @match        https://bangumi.tv/<br>// @match        https://bgm.tv/<br>// @match        https://chii.in/<br>// @icon         https://bgm.tv/img/favicon.ico<br>// @grant        none<br>// ==/UserScript==<br><br>(function () {<br>    'use strict';<br><br>    const style = document.createElement('style');<br><br>    style.innerHTML = `<br>        #timeline ul li .card .inner .title small.grey {<br>            display: block;<br>        }<br>        #timeline ul li .card.card_tiny .inner .title small.grey {<br>            display: none;<br>        }<br>        #timeline ul li .card.card_tiny:hover .inner .title small.grey {<br>            display: inline;<br>        }<br>        #timeline ul li .card.card_tiny:hover .inner .title small.grey {<br>            display: block;<br>        }<br>        #timeline ul li.tml_item .card.card_tiny {<br>            max-height: unset;<br>        }<br>        #timeline ul li.tml_item .card.card_tiny .info {<br>            display: none;<br>        }<br>        #timeline ul li.tml_item .card.card_tiny:hover .info {<br>            display: block;<br>        }<br>    `;<br><br>    document.getElementsByTagName('head')[0].appendChild(style);<br><br>    function swapTitlesAndSubtitles() {<br>        const cardElements = document.querySelectorAll('.card:not([data-swapped])');  // 只选择还未处理过的.card元素<br><br>        cardElements.forEach((card) => {<br>            const titleElement = card.querySelector('.title');<br>            const subtitleElement = titleElement.querySelector('.subtitle');<br><br>            if (titleElement && subtitleElement) {<br>                const fullTitleText = titleElement.textContent.trim();<br>                const subtitleText = subtitleElement.textContent.trim();<br><br>                if (subtitleText === '') {<br>                    card.setAttribute('data-swapped', 'true');  // 标记该.card元素已经被处理过<br>                } else {<br>                    const pureTitleText = fullTitleText.replace(subtitleText, '').trim();<br><br>                    // 重新组合.title和.subtitle<br>                    titleElement.innerHTML = `${subtitleText} <small class=\"grey\">${pureTitleText}</small>`;<br><br>                    card.setAttribute('data-swapped', 'true');  // 标记该.card元素已经被处理过<br>                }<br>            }<br>        });<br>    }<br><br>    swapTitlesAndSubtitles();<br><br>    const observer = new MutationObserver(function (mutations) {<br>        swapTitlesAndSubtitles();<br>    });<br><br>    observer.observe(document.body, { childList: true, subtree: true });<br>})();</pre></div>","time":"2023-10-20 02:19","title":"[脚本/组件] 移除新版时间线卡片或评分，条目恢复原名","userId":"eien","userName":"默沨","userSign":"(星梨花/環/弥生/桃子/杏奈P)"}
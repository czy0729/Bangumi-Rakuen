{"id":29454,"avatar":"//lain.bgm.tv/pic/user/m/000/08/95/89561.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"昨天晚上留的坑，今天早上开始做事情之前填一下好了……<br><br>嘛其实最近在给 Firefox 实现 CSS3 计数器样式里面的东亚文字计数器样式部分，也就是添加 list-style-type 和 counter() 支持的值，让其可以显示“三十八”、“六十九”这样的计数器风格的东西，包括了中日韩三个语言一共9种样式。<br><br>我本来觉得这是件挺简单的事情，最麻烦的部分莫过于生成这些文字了，反正想一想应该就没问题了，而且后来发现标准文档里也有标准算法，Firefox 还内置了原来的一个（实际上是有错误的）生成算法以供参考。<br><br>但是写着写着发现不是这么简单的事情，最麻烦的事情是一个开始根本没发现的问题：后缀后面的空白区域。<br><br>原来的阿拉伯数字一系的编号，后缀都是一个点“.”，浏览器为了让它显示着美观，在数字列和列表文字之间留了一段空白（默认字体下大约是0.5em），这本来挺好，但是中文的后缀“、”是自带高达0.5em的空白的，这样整个空白长度就变成了1em，太宽了。<br><br>我一开始的做法是把预留的空白变成空格塞到“.”的后面，但是这个受到了 reviewer 的反对。现在来说我是接受他反对的理由的：1、空格的宽度在字体之间不稳定；2、未来如果加入自定义 counter-style 就会变得很麻烦（实际上就是同一个标准中的内容，暂时还没实现）；3、导致一些涉及双向文字的代码大大复杂化。<br><br>来回了几个 comment 之后他提出可以使用字体的 hwid 特性将“、”替换成等效的半宽度字符以解决空白过大的问题。然后我又去学习和咨询了一通，然后测试了一下，发现对于“、”，我系统上几个主要中文字体没一个支持 hwid 这个特性的。而另外一个类似的特性 halt 也仅有一个非默认的中文字体支持。Twitter 上的一个朋友也告诉我中文字体基本都不支持 halt，有支持很多都是来自日文字体。（测试中唯一支持的是 Hiragino Sans GB，确实是日文字体过来的）然后另一个字体专家告诉我说，不要依赖这种字体高级特性，太脆弱了，而且遇到比如港台顿号放中间的情况就会出问题。<br><br>这就是现在的进度，昨天晚上睡前有一个新想法，一会儿实现一下试试看，希望没问题。<br><br>我只是想抱怨一下本来一个根本没被当做问题的东西结果牵扯出了这么多问题，当然也了解了一些相关知识，算是有所收获了…… ","time":"2013-11-8 00:58","title":"发个贴抱怨一下","userId":"upsuper","userName":"upsuper","userSign":""}
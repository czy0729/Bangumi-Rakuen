{"avatar":"//lain.bgm.tv/pic/user/m/000/18/11/181122.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"受<a href=\"/user/leon92101\" class=\"l\">@御户白夜</a> 所托，写了一个小脚本，提供查看该名用户最近状态的功能，然后在今天上班<span style=\"text-decoration: line-through;\">摸鱼</span>的时候写好了。本来还打算把上次<a href=\"/user/liaune\" class=\"l\">@君寻</a> 想要的好友评分功能也加上，但是因为涉及到多页面加载一下子没写好，想着先发布一部分的功能，就直接先发了。<br><br>第一个版本就只能显示好友名字/是否已加好友/最后一条timeline/共同喜好/同步率。<br>接下来两天我把抓取好友评分部分写好之后再发新版本。<br><br>这个脚本在bgm.tv所有页面（暂不支持超展开页面）里面都会生效，如果你在首页或者自己的好友页面里面使用的时候可能会发现你看到的所有人都是“xxx已经是你的好友”<span style=\"text-decoration: line-through;\">（这是显然的。</span>你试试在小组讨论帖或者别人的好友列表里刷一刷就会看到区别了。。。<br><br>如果正在是用@everpcpc 的（最新版）条目脚本，同时打开两个脚本信息窗口会产生遮挡（我的会把他的挡住，建议只用一个<br><br>[!]如何看某用户的非动画条目评分及分布<br>考虑到一部分用户的特殊需求，我做了相应的适配。但我个人主观上并不想让这个脚本的定制化程度太高，我留了一个配置在代码里面，如果有这方面需求的同学可以打开脚本代码，然后大概在第40行左右有一块被框起来的注释说明，按照注释里面说的操作就好了。<br>修改完保存之后请务必清空相应的localstorage（删除key值为fifth_bgm_user_userjs_scores的记录即可），不然有一定可能数据显示会不正确<br>*同时只能触发一种类型条目的追踪*<br><br>下面的截图为最早的版本，懒得换了。。。<br><br>[效果图]<br><img src=\"https://ooo.0o0.ooo/2017/03/03/58b86651bb6bf.png\" class=\"code\" alt><br><br><a href=\"https://github.com/bangumi/scripts/tree/master/fifth\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">github项目地址</a>    |    <a href=\"https://github.com/bangumi/scripts/raw/master/fifth/friendsPowerUp.user.js\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">脚本安装/更新</a><br>（建议使用Tampermonkey来管理插件（尤其是对于火狐浏览器用户<br><br>由于沉迷塞尔达，所以我大概短时间内不会更新新功能上去了。。。<br><br>更新日志<br>20170323 v1.2.4    1.现在支持不同类型条目的斯托卡（但同时仅支持一种类型，默认动画），修改方法见上面<br>                               2.修复一处可能会造成控制台报错的地方（报错不影响功能）<br>20170323 v1.2.3    修复了读取某些用户（时光机右侧列表）的数据时出错的情况<br>20170322 v1.2.2    1.修复了在某些情况下看过动画数量出现错误的情况（调整了数据抓取策略<br>                               2.改了名字和描述<br>20170321 v1.2.1    修复了查看自己的均分时显示别的用户的数据的bug<br>20170321 v1.2.0    1.添加了设置中心，现在可以对斯托卡的内容进行设置<br>                                       可设置的内容包括：显示的内容选择，计分方式，是否包含标准差<br>                                       设置方式为勾选，鼠标从窗口移开，浮窗消失即保存生效<br>                               2.存储格式改变，v1.2.0会检查脚本的版本，会自动清空旧版本的缓存，你也可以手动清除<br>                               3.其它大量的修复和改动，我几乎把全部的代码重新写了一遍<br>20170317 v1.1.6    1.修复了一处遮挡问题<br>                               2.查看自己的信息时，最上面的那句话的内容现在是随机的<br>20170317 v1.1.5    1.加载的进度条现在是一根进度条而不再是文字了<br>                               2.修复了在斯托卡不看动画的用户时永远卡进度条的错误<br>                               3.文案上的调整<br>20170316 v1.1.4    1.修复了一处遮挡问题<br>                               2.现在会在请求个人信息的时候就抓取条目标记数，所以会显示看过数和抛弃数<br>                                       在不需要更新分数信息的情况下可以减少一次网络请求<br>                               3.其它代码结构的小优化<br>20170315 v1.1.3    1.现在可以把分数分布图画出来了<br>                               2.浮窗透明度取消了（为了使图看得更清楚<br>20170314 v1.1.2    1.现在的计算不再包含未评分的作品，用户均分应该会比之前高一点了<br>                               2.顺便计算了一下标准差<br>                               3.查看自己的时候那句话的样式稍微改了一下<br>20170313 v1.1.1    1.现在可以stk自己了（仅能显示最近tl），所以可以查看自己的均分了<br>                               2.现在把鼠标放在“时光机”按钮上不会出现浮窗了<br>                               3.最近一个登陆的用户uid会被保存在localstorage，但未登录状况下依然不能使用本插件<br>20170312 v1.1.0    现在可以查看用户的看过动画均分了<br>20170306 v1.0.10  修复了上个版本修复导致的某些页面（如首页）头像不能触发浮窗的bug<br>20170305 v1.0.9    1.修复了两处会在控制台报错的情况（报错并不影响功能<br>                               2.加入了淡入淡出效果<br>                               3.其它代码调整优化<br>20170304 v1.0.8    1.现在把鼠标从头像或名字上移开之后信息窗不会立即消失<br>                                       鼠标指向另一个头像或名字或者从信息窗口上移开鼠标窗口才会消失<br>                               2.信息窗口里的用户名字现在可以点击了<br>                               3.调整了数据请求策略，现在只要鼠标指向头像或名字就会在后台加载<br>                                       可以把鼠标移开过会儿再回来看，这边有一个已知bug*<br>                               4.其它代码结构的调整<br>20170304 v1.0.7    1.调整了搜索策略，现在所有信息只向一个页面（用户主页）发起请求，减少了请求次数<br>                               2.添加了缓存，每个会话（不刷新页面）对每个用户只发起一次请求，减少了请求总数<br>                                       第二次查看用户数据时会直接读取缓存的数据，几乎没有等待时间（thx to <a href=\"http://bgm.tv/user/laoism\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">林卯</a><br>                               3.添加了正则来预处理返回数据，节省了大量的流量和内存<br>                                       正则搭配jquery使用，避免用jquery处理大DOM（thx to <a href=\"http://bgm.tv/user/prevails\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">Donuts.</a><br>                               4.调整了信息窗口的展示位置，现在窗口位置不再取决于元素位置而取决于鼠标的位置<br>                               5.其它的代码调整优化<br>20170303 v1.0.6    1.修复了异步加载内容的触发事件（thx to <a href=\"http://bgm.tv/user/prevails\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">Donuts.</a><br>                               2.代码结构调整<br>20170303 v1.0.5    1.修复了某些状况下不该触发事件的情况<br>                               2.fecs检查<br>20170303 v1.0.4    1.样式调整，现在名字是蓝色的<br>                               2.扩展了会触发事件的元素范围，比如@别人的链接也可以，小组成员页也可以了<br>                                       但是还是有些地方显示不了，比如自己首页TL里面第二页开始就都失效了。。。<br>20170303 v1.0.3    1.修复在某些非用户头像的图像上也会触发的情况<br>                               2.其它小修复<br>20170303 v1.0.2    1.更换timeline信息的来源<br>                               2.定位调整<br>                               3.文字调整<br>20170303 v1.0.1    1.自己的头像不会触发<br>                               2.其它小修复<br>20170303 v1.0.0    发布（注意此脚本并不会在所有的头像上都触发，有个别的头像不会触发（比如小组成员页<br><br>更新计划：<br>图片资源改成https协议<br>数据抓取过程中可能出现重叠现象<br>触发显示信息的事件的扩展和修复<br>为超展开页面（iframe）做单独的处理<br>把脚本写的更优雅一点<br><span style=\"text-decoration: line-through;\">在时光机读取数据时的策略调整</span><br><span style=\"text-decoration: line-through;\">火狐浏览器greasemonkey插件兼容问题（找不到原因，放弃了，请使用Tampermonkey</span><br><span style=\"text-decoration: line-through;\">加入配置中心，提供多种配置方案（具体提供啥再说，也许会有条目种类，标记状态，计算方法，功能选择等等之类的）</span><br><span style=\"text-decoration: line-through;\">优化加载流程</span><br><span style=\"text-decoration: line-through;\">美化（增加动画/图表等）</span><br><span style=\"text-decoration: line-through;\">加入评分分布图</span><br><span style=\"text-decoration: line-through;\">支持查看自己的信息/均分</span><br><span style=\"text-decoration: line-through;\">新功能：用户看过数/均分计算</span><br><span style=\"text-decoration: line-through;\">[bug]部分页面鼠标放上去弹窗会疯狂闪烁然后永远加载不出来<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">，如小组成员页的人名</span><br><span style=\"text-decoration: line-through;\">[bug*]鼠标从一个头像上移开并迅速移回，有可能会出现一直卡进度条或者显示别的用户的信息的情况，再次移开并移回可恢复正常</span><br><span style=\"text-decoration: line-through;\">[bug]网页异步加载内容没有被绑上事件，如个人主页翻页后、超展开页面等</span> ","time":"2017-3-3 02:46","title":"[userjs]成为一名斯托卡--用户头像信息增强","userId":"fifth","userName":"fifth","userSign":"(人型自走单线程大脑培养皿#5)"}
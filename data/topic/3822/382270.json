{"id":382270,"avatar":"//lain.bgm.tv/pic/user/m/000/30/41/304116.jpg","floor":"#1","group":"～技术宅真可怕～","groupHref":"/group/a","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/00/11.jpg","message":"API: <br>POST https<span style=\"font-size:0px; line-height:0px;\"></span>://bgm.nyamori.moe/forum-enhance/query<br>格式: {\"users\":[\"304116\",\"trim21\",\"sai\"],\"type\":\"group\"}<br>- type可以是group, subject, blog, ep, character, person<br><br>Userscript:<br><a href=\"https://openuserjs.org/scripts/gyakkun/Bangumi_Forum_Enhance_Alpha\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://openuserjs.org/scripts/g ... Forum_Enhance_Alpha</a><br><br>--------------------<br><br>230826 Update<br><br>- Userscript 支持日志发言统计<br><br>- Userscript 修正一处因未考虑时区导致的日期格式化问题<br><br>上述更新于Userscript 0.0.17 版生效<br><br>--------------------<br><br>230706 Update<br><br>- API / Userscript 新增支持章节、人物、角色的回帖统计。<br><br>说明: 章节对应的\"空间\"即条目。置鼠标于章节标题上可查看对应条目的日文标题。<br><br>另外 <a href=\"https://openuserjs.org/scripts/gyakkun/Show_History_Link_in_Group_and_Subject_Topic_Alpha\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">历史页</a>、<a href=\"https://openuserjs.org/scripts/gyakkun/Bangumi_Deleted_Post_Alpha\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">查看删除回复</a> 这两个UserScript现也支持 章节、人物、角色 页面。人物、角色的历史页链接在左侧。<br><br>--------------------<br><br>230617 Update<br><br>- 适配 r427 中的折叠回复统计, 在帖子统计中以靛蓝色 (F) 为标识符。<br><br>说明: 站长的用词是Collapsed , 因易与 C - Closed (主题被关闭) 产生歧义, 故选用 F - Fold 作为标识符。<br><br>更新至Userscript 0.0.13 版本及以上生效。<br><br>( 如遇点击▼无响应(*), 请尝试<a href=\"https://support.plaympe.com/portal/en/kb/articles/clear-cache-cookies-indexeddb-associated-with-caster\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">清理IndexedDB</a> (6) )<br><br><img src=\"https://p.sda1.dev/11/62933beab2a386f043f59ddab813c820/image.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>--------------------<br><br>230529 Update<br><br>- 更新本主题标题 (旧: bgm论坛功能统计API/Userscript)<br>- 新增按空间贴贴数目统计<br>- 新增最近送出贴贴栏目<br>  - 点击贴贴表情图片可定位至相应回复<br><br>更新至Userscript 0.0.12 版本及以上生效。<br><br>( 如遇点击▼无响应(*), 请尝试<a href=\"https://support.plaympe.com/portal/en/kb/articles/clear-cache-cookies-indexeddb-associated-with-caster\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">清理IndexedDB</a> (6) )<br><br>如图:<br><img src=\"https://p.sda1.dev/11/84dec0a15da8eb5a7d44a4d286552e1f/ba_feh_like_rev_space_demo.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>---------<br><br>230526 Update<br><br><a href=\"https://bgm.tv/group/topic/381597\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">原帖</a>此前未经考虑发到了茶话会, 经提醒应该发到技术宅小组, 特此重发。<br><br>得益于r418~r420的更新, 现已能获得送出贴贴的用户username。<br>新增\"送出贴贴统计\", 于Userscript 版本 0.0.9 及以上生效。效果如图:<br><br><img src=\"https://p.sda1.dev/11/0cfa36fc76f166e63f2e5d6a26e92076/ba_feh_like_rev_demo.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>另外很多班友感兴趣谁收到或者送出最多r417中被删的贴贴表情。注意到有班友利用API做了<a href=\"https://bgm.tv/group/topic/382220#post_2346614\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">一些统计</a>, 但当时的数据因历史贴贴被删导致不完整, 可以以下面的为准。这里展示以<用户, 表情>为元组进行归纳后贴贴数量前10的行, 范围是小组讨论+条目讨论, 以bgm-archive项目收集到的数据为限。<br><br>value=118即流汗电视表情( <img src=\"/img/smiles/tv/79.gif\" smileid=\"118\" alt=\"(bgm102)\"> )<br><br>送出前10:<br>value,username,nickname,count<br>118,704504,1毫米的上善不举,901<br>118,650688,国见佐彩,285<br>118,535873,Thor,259<br>118,551665,三尖酸努努,227<br>118,wlx321,wlx321,212<br>118,582729,看动画好累,189<br>118,309098,Arclight,182<br>118,785058,TTK,176<br>118,atu78963254,膠原蛋白,172<br>118,320717,调月穹乃,166<br><br>收到前10:<br>value,username,nickname,count<br>118,awesome_failure,bangumi政委,1132<br>118,kusakiii,Kusaki,875<br>118,746870,清洁工&#x1F1FA;&#x1F1F8;&#x1F1EF;&#x1F1F5;&#x1F1F9;&#x1F1FC;&#x1F1FA;&#x1F1E6;,676<br>118,furukawa,牵着古河看汐阳,641<br>118,448853,Asahi,438<br>118,forbear,陈平方,380<br>118,309098,Arclight,366<br>118,kusaki,准时不早退的圣嘉然,359<br>118,jsgfshakak,技术规范书阿卡卡,352<br>118,217781,金刚可怜,322<br><br>将来的开发计划包括纳入人物、角色、章节中的相关信息, 特别是章节中的贴贴数据。此前因为章节数量过大 (章节 1200k , 小组讨论 380k , 条目讨论  25k) 未将其纳入爬取计划中。<br><br>爬取毕竟占用了大量的服务器资源, 希望能有朝一日将收集到的数据以一种恰当且不违反站规的形式进行披露(年鉴?)。<br><br>----------<br><br>230519 Update<br><br>新增 “因含有「社区指导原则」不提倡的内容被折叠” 的帖子状态统计。在“帖子统计”中以 \"V-Violative\" 为标识符。启用0.0.8版本的Userscript后效果如下图所示。<br><br><img src=\"https://p.sda1.dev/11/d585890c42a16fd88dba4e88bdfc2e5c/ba_feh_violative_demo.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>--------<br>230510 New<br><br>API: <br>POST https<span style=\"font-size:0px; line-height:0px;\"></span>://bgm.nyamori.moe/forum-enhance/query<br>格式: {\"users\":[\"304116\",\"trim21\",\"sai\"],\"type\":\"group\"}<br>- type可以是group, subject, blog。<br><br>Userscript:<br><a href=\"https://openuserjs.org/scripts/gyakkun/Bangumi_Forum_Enhance_Alpha\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://openuserjs.org/scripts/g ... Forum_Enhance_Alpha</a><br>目前只挂在group/subject。有兴趣可以基于API做二次开发。<br><br>说明:<br>- 主题统计: T-Total 总数, D-Deleted 已删除, S-Silent 下沉, C-Closed 管理员关闭, R-Reopen 重开<br>- 帖子统计: T-Total 总数, D-Deleted 已删除, AD-Admin Deleted 管理员删除<br>- 时效性: 服务端缓存2h, 源数据会有15~30min的延迟, 不保证实时更新, 视乎服务器状态。<br>- 数据质量: 源于<a href=\"https://bgm.tv/group/topic/374807\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">bgm-archive</a>项目, 从2022-11开始收集数据, 所以在这之前被删的主题不会纳入统计。目前计划每月遍历一次所有主题以完善被删主题的数据。另外主题⊆帖子, 即如果有号注册完发帖一击脱离会显示为帖子1(T) 主题1(T)。<br>- Userscript: 不会网页前端, 乱写的, 样式可能会有很多bug(特别是和贴贴冲突), 视乎有没有空摸鱼, 可能修也可能不修。欢迎编写更好的。<br>- 点了没反应: 经由Cloudflare CDN, 请自行确保对CF网络的连接性, 如果(bgm.tv / chii.in)域名访问正常应该就没有问题。<br><br>鸣谢:<br><a href=\"/user/neutrinoliu\" class=\"l\">@徒手开根号二</a><a href=\"/user/fotile96\" class=\"l\">@大的药</a><a href=\"/user/chengchung\" class=\"l\">@&#x1F426;</a><br><br>Demo:<br><img src=\"https://p.sda1.dev/11/59595b5459db306744f5e9e323ab7586/ba_feh_demo_gif.gif\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt> ","time":"2023-5-26 23:43","title":"[230826 Update] 发帖/回帖/贴贴 统计API/Userscript","userId":"304116","userName":"gyakkun","userSign":""}
{"id":373641,"avatar":"//lain.bgm.tv/pic/user/m/000/69/55/695549.jpg","floor":"#1","group":"靠谱人生茶话会","groupHref":"/group/boring","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/03/364.jpg","message":"<span style=\"text-decoration: line-through;\">分享癌又犯了</span><br>开新坑了！趁着国庆假期大家比较有空折腾更新一篇复杂的教程~（虽然已经6号了=v=）<br><br>这次更新的是如何自己搭建一个自己追番/补番or和朋友一起分享的番剧影视服务器<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">    这次的搭建相比前几个帖子都更加复杂，也更需要Linux的基础（当然其实照着复制粘贴应该也是ok的），我会尽量写的更加简单明了，如果实在是感觉麻烦但也想用一下的话可以私戳我，我分享我的服务器给你~（不过不能分享太多人，毕竟服务器流量有限<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">）<br>先看看最终成果<img src=\"/img/smiles/tv/82.gif\" smileid=\"121\" alt=\"(bgm105)\"><br><img src=\"https://earendilist.tk/d/Movie/pic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-06%20135558.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><img src=\"https://earendilist.tk/d/Movie/pic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-06%20135621.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><img src=\"https://earendilist.tk/d/Movie/pic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-06%20135905.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>需要的设备：NAS/VPS一台，一个够大的网盘（本文使用OneDrive，可以使用谷歌、阿里云），Ctrl+C/V（误）<br><br>一、实现目标<br><br>实现目标很简单，通过网盘建造自己的资源库，预算低廉（只有服务器的钱，一年一两百，可以N个人分），大部分都是在嫖（笑），以及实现新番自动更新，再也不用到处找小网站了。<img src=\"/img/smiles/tv/01.gif\" smileid=\"40\" alt=\"(bgm24)\"><br><br>二、VPS推荐<br><br>NAS的话自不必说，对有nas的朋友应该会有自己的硬盘，那可以跳转至自动订阅和网盘两条内容。VPS的话，租用服务器需要G口以上的服务器，现在便宜服务器特别多，年付十几刀的很多，也不乏好厂商，具体可以参考一些分享网站（<a href=\"http://www.vpsxxs.com/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">http://www.vpsxxs.com/</a>     <a href=\"https://www.veidc.com/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://www.veidc.com/</a>）。在这里的话就仅分享我自己用的绿云<a href=\"https://greencloudvps.com/billing/aff.php?aff=3966\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Greencloud</a>的10G口服务器，年付就15/25刀，究极高速，流量挺多，是挂网盘的好伙伴。具体的话是注册登录，右上角切换语言，然后是上栏的服务、订购新服务，在Budget KVM和Premium KVM里面选一台。具体可以通过<a href=\"https://greencloudvps.com/data-centers.php\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://greencloudvps.com/data-centers.php</a>里面的测试ip查看自己的网络是否合适来选择地区，我自己试过一轮，大概芝加哥和圣何塞（San Jose）的适合电信联通网络，对移动都不是那么友好。<br><br>当然，绿云是我自己挑选的适合我这里网络的服务器，其他服务器其实只要满足：G口，不小于10g的硬盘，不小于1g内存，以及合适的流量（可以按你每天看动画片什么的数据量来算，两三个人看就一月1T都够了），满足这些就够了，请在购买之前好好测试网络（去itdog.cn去测VPS服务商给的测试ip），避免花冤枉钱。<br><br>三、安装所需要的服务<br><br>在这里我们需要五个服务。首先是rclone，挂载网盘用的好用工具。其次是Docker，我们赖以开展其他服务的基础。然后是Nastool，由国人开发的相当全能的订阅、整理工具。接着是qbittorrent，Nastool的下载器。最后是emby，媒体服务器。我的习惯是用Ubuntu，所以安装的是Ubuntu 20.04系统，踩的坑也都是在Ubuntu里面踩的，如果是Linux新手可以跟着一步步来。有自己习惯的Linux系统也是完全没问题的，毕竟docker是个跨平台通用的东西。<br><br>虽然教程面向纯新手，不过有些知识可以通过搜索引擎很方便查到，关于如何ssh连接服务器之类的教程就不多说了。连接上系统后，首先要安装几个必要的组件（我们全程在用root用户进行处理）：<br><br>sudo -i<br><br>apt update<br><br>apt upgrade<br><br>apt install unzip gpg fuse curl nano<br><br>rclone的安装：<br><br>curl <a href=\"https://rclone.org/install.sh\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://rclone.org/install.sh</a> | sudo bash<br><br>docker的安装：<br><br>请下载<a href=\"https://earendilist.tk/d/EduMovie/tool/docker.txt\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这个txt文件</a>，以下所有rclone/docker操作的都在里面了。<br><br>以上，我们安装好了我们需要的基础服务<br><br>下面的几个项都有更改目录的选项，如果你是新手，那建议不进行修改，复制粘贴也能完成以下操作。<br><br>四、网盘配置<br><br>第一个重点来了，如何配置以及挂载网盘到服务器里，是我们能否实现的关键。<br><br>1. 首先rclone config部分，OneDrive请参考<a href=\"https://walixz.com/rclone-sync-onedrive.html\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这个教程</a>1-4点，谷歌盘请参考<a href=\"https://www.qcmoke.site/tools/rclone.html\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这个教程</a>的1-2点，阿里云盘比较麻烦，而且我们买国外服务器也不是很适合这个，方法是通过alist挂载为webdav，请参考<a href=\"https://alist.nn.ci/zh/guide/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://alist.nn.ci/zh/guide/</a>的内容挂载alist，以及rclone挂载webdav的教程。<br><br>2. config完成后，我们需要让它开机自启动，这里提供一套我自己的挂载参数，里面写了可以修改的内容。需要修改的内容：网盘路径<br><br>​        挂载参数请查看docker.txt文件。你的网盘将挂载在/home/rclone/<网盘名称>中<br><br>一切输入完成后，输入df -h查看是否挂在成功，看到有个巨大的盘就是成功了。<br><img src=\"https://earendilist.tk/d/Movie/pic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-06%20134126.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br><br>在进入docker相关教程前，首先做一点点docker-compose文件的小科普。主要是volumes一栏，下方会有  路径1:路径2这个形式，路径1为你服务器实际上的文件夹路径，路径2为docker启动的软件读取的文件夹路径，也就是做了个映射，/路径1会映射为/路径2，外部存文件要存在/路径1，docker中的软件要读取/路径2.<br><br>五、媒体服务器Emby配置<br><br>为什么用emby呢？因为我是穷穷二次元，emby破解多（笑）。我们采取的是<a href=\"https://hub.docker.com/r/lovechen/embyserver\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">lovechen的版本</a>。<br><br>首先在创建一个文件夹，位置任意，用于存放docker相关的设置文件，更改的路径要在后面的compose文件中相应修改。比如我创建的/root/docker，emby在/root/docker/emby里面，创建一个docker-compose.yml文件<br><br>nano docker-compose.yml<br><br>复制粘贴在docker文件中的emby部分，需要路径修改的已经标出。<br><br>然后在有docker-compose.yml的文件夹输入docker-compose up -d即可。<br><br>在你的电脑/手机浏览器上输入ip:8096即可访问你的emby，初始设置可以一路skip，媒体库待会再说。<br><br>媒体库：在/movie文件夹内，按需配置，建议使用tmdb的刮削，带中文。刮削教程可以参考<a href=\"https://www.bilibili.com/video/BV1L44y167SZ/?vd_source=f0fb5e9dad3742635becc3ba54fd2ab7\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这个视频</a><br><br>用户配置：重要！用VPS的朋友请在每个用户配置时关掉所有带有转码、转换字眼的设置项，服务器的配置并不足以进行软解，开了转码会使得看视频的时候cpu高占用而卡顿的。<br><img src=\"https://earendilist.tk/d/Movie/pic/%E5%B1%8F%E5%B9%95%E6%88%AA%E5%9B%BE%202022-10-06%20134507.png\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>观看方式：可以直接通过ip:8096访问网页，也可使用客户端食用。建议下载客户端，因为如果网页观看由于网页解码能力太弱了，很多视频播放不了。这里给出两个修改（破解）客户端：<a href=\"https://danmaku.movie.kg\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://danmaku.movie.kg</a>这个最推荐，因为支持弹幕（弹弹play库），内含安卓Windows和ios三种客户端。mac用户请参考这个 <a href=\"https://embywiki.911997.xyz\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://embywiki.911997.xyz<br></a><br>六、下载器qbittorrent配置<br><br>这个里面有点坑要踩。在docker.txt文件里面找到qbit相关内容，一样是创建compose文件粘贴内容然后docker-compose up -d。浏览器进入ip:8080后，默认账号密码为admin/adminadmin。进入后在设置-webui里面更改好账号密码以及换中文。<br><br>然后，在设置-下载中更换默认下载路径，注意事项在docker.txt注释中已经写出~<br><br>配置好后，去种子站（动漫花园，蜜柑计划）找个磁链测试一下能否下载。<br><br>七、订阅服务Nastool配置<br><br>首先奉上Nastool的教程（<a href=\"https://github.com/jxxghp/nas-tools/wiki/%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">Github</a>   ， <a href=\"https://post.smzdm.com/p/a7nxrz2g/\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">教程2</a>）和telegram频道（<a href=\"https://t.me/nastool_chat\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">交流群</a>   <a href=\"https://t.me/nastool\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">更新群</a>），因为这里只讲配置，里面还有很多很多好用的功能，作者也特别肝，几天一更，迫真肝帝。<br><br>配置：跟emby差不多，复制内容后在你设置的存放设置文件夹创建docker-compose.yml文件，然后docker-compose up -d即可。浏览器进入ip:3000配置，初始密码admin/password。<br><br>在设置-基础设置中，有几项需要设置。第一个是默认管理密码，在第一栏web管理处修改。第二个是基础设置-媒体中：tmdb api申请，请参考<a href=\"https://new.qq.com/rain/a/20220222A022LM00\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">这个教程</a>  ，申请完成后填写api。默认文件转移方式：我们用的VPS+网盘，直接采用移动是体验最好的。rclone移动，对于媒体库刷新有延迟，而且配置略麻烦，8太行。二级分类策略处删除，如果要用请参考教程，在我们教程里面就从简了。<br><br>设置-媒体库中请配置目录到你需要的目录，比如网盘挂载的某个子目录。例如我的在/home/rclone/movie/Animate里面，在Nastool的挂载中将/home/rclone/movie挂载为了/movie，那么在媒体库就填写：/movie/Animate。当下载订阅启动，Nastool会在这个目录下根据不同的番剧创建子文件夹。<br><br>设置-索引器中，番剧一般采用公开站点就够了，私有站点就pt站，这个等等说。一般你用花园/蜜柑其中之一（这两源好像是一样的），ACG.RIP，MioBT，四选一即可，反正基本都一样，选多了更新还慢。要看剧就加一个RARBG就好。<br><br>下载器部分，配置你的qbit，ip端口账号密码，目录就填你刚刚qbit设置的默认目录即可，测试是否可用。<br><br>媒体服务器部分，填写emby地址和api（api在emby设置里面有个选项，生成一个来用）。<br><br>消息通知、豆瓣、字幕等请去nastool频道搜索或者问人，挺简单的。<br><br>然后如果你有pt站，请在站点管理-站点维护处添加。站点管理处也添加一下公开站点的rss，例如蜜柑的<a href=\"https://mikanani.me/RSS/Classic\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://mikanani.me/RSS/Classic</a>  。如果是公开站点，用途选订阅即可。<br><br>然后到了订阅~为了实现新番订阅可真是麻烦呢。订阅的话推荐自定义订阅填写你的蜜柑计划订阅，选片简单还会跟着你的订阅自动更新。当然直接在电视剧订阅一个个搜工作量也差不多。搜索站点处选一俩个，订阅站点也一两个就好，正确填写标题和季度后就可以顺利订阅了<br><br>当有新的番剧更新，Nastool将会自动下载并转移到你的网盘对应目录并且提醒emby刷新媒体库，rclone会自动上传，这也就是我们的自动订阅全流程了~<br><br>八、总结，以及白嫖指南<br><br>看到这里可能很多朋友会觉得太难了hhh  其实不是很难，操作也比较基础，主要是凑自己的媒体库比较难。目前的话，免费的网盘方便转移的是e5 OneDrive+mover的模式，e5本身是一个不算稳定的计划，曾经容易嫖到，续订还算稳定，但现在好像有点难申请成功，可以试一试（e5教程&#x1F449;<a href=\"https://zhuanlan.zhihu.com/p/105438817\" target=\"_blank\" rel=\"nofollow external noopener noreferrer\" class=\"l\">https://zhuanlan.zhihu.com/p/105438817</a>）。如果没法申请，可以几块钱买个子账号来用。从零开始积攒一个媒体库是很难的，我攒了两个月攒了6T左右，145部番＋115部剧场版，实在是很枯燥的过程。所以如果你有一个5T的OneDrive，需要我的资源，请私戳我，我可以通过mover转移给你，然后请你在别人需要转移资源库的时候提供帮助。以及我也提供一辆公交车，是我新开的e5小号，供各位使用（由于多人共用肯定会触发一定的api限制，因此我会控制一下人数=v=，需要的朋友就私戳吧）。如果是用公交车/复制了我的盘的朋友，我这里提供了我自己的emby配置文件，解压后compose即可食用，不需要扫扫描媒体库（扫盘会触发高频调用，一段时间后网盘速度会下降，如果很多文件一般要停很多次，如果扫盘卡住了请你停止rclone进程再重启docker，不要直接重启机器！）。以及真-白嫖：如果实在觉得操作不来，我也可以给你开一个我自己服务器的号~不过这个肯定有限，毕竟服务器流量带宽有限，就先到先得吧<img src=\"/img/smiles/tv/01.gif\" smileid=\"40\" alt=\"(bgm24)\"><br><br>盘内资源来自很多很多的压制组和字幕组，我也尽可能在文件命名方面留下了他们的名字，对他们致以深深的谢意！！！！<img src=\"/img/smiles/tv/82.gif\" smileid=\"121\" alt=\"(bgm105)\"> ","time":"2022-10-6 14:02","title":"趁着放假，折腾一个属于自己的看番小网站吧！","userId":"695549","userName":"Earendil_C","userSign":""}
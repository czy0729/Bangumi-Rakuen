{"id":352373,"avatar":"//lain.bgm.tv/pic/user/m/000/26/12/261227.jpg","floor":"#1","group":"番组开发","groupHref":"/group/dev","groupThumb":"//lain.bgm.tv/pic/icon/m/000/00/41/4180.jpg?r=1519373244","message":"RT。简单点来说，想写个小圣杯的插件，但是现在遇到个问题：<br>我想在个人主页的小圣杯tab里添加一个按钮。<br>效果如图：<br><img src=\"https://i.loli.net/2019/09/02/AcPn9pfSzkIamVt.jpg\" class=\"code\" rel=\"noreferrer\" referrerpolicy=\"no-referrer\" alt><br>这需要小圣杯本身的组件XHR先执行完成，但是正常情况下两个组件都是加载完成后就开始执行了，<span style=\"font-weight:bold;\">结果我的脚本就会因为找不到小圣杯相关的HTML DOM元素而执行失败，无法添加按钮</span><br><br><br>我自己的解决方法有2个：<br>1.用“setTimeout”来强行延迟我自身组件的开始执行时间，但是过于粗暴，而低网速环境下还是会提前执行。<br>2.将按钮上移，从小圣杯相关的DOM里迁移至BGM原先的页面元素中，这样的话无论如何一开始都能将按钮添加完成，同时将是否运行组件的时机交了给用户自己判断。但是这种方法会让UI有一种割裂感。<br><br>所以想问下各位有什么更好解决之道吗？毕竟JS我也就会一点点，很多新特性都没了解过<br><br>update:<br>目前采用的是#3提供的“MutationObserver”方法，自己这边低网速和高网速的情况下测试了貌似效果才行，虽然偶尔有监控不到的情况，不过准备先这样了。<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"> ","time":"2019-9-2 06:49","title":"[求助]如何确保另一个组件执行完后再开始执行自己的组件","userId":"261227","userName":"chitanda＠Lv2","userSign":"(Make Bangumi Great Again!)"}
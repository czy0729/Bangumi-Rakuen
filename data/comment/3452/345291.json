[{"avatar":"//lain.bgm.tv/pic/user/m/000/17/18/171851.jpg","floor":"#2","id":"1324684","time":"2018-3-8 22:59","userId":"yonjar","userName":"🍋LautlosP🍋","userSign":"(DD集まれ! (๑•̀ㅂ•́)و✧)","message":"mark","sub":[]},{"avatar":"//lain.bgm.tv/pic/user/m/000/34/68/346809.jpg","floor":"#3","id":"1324688","time":"2018-3-8 23:03","userId":"windrises","userName":"windrises","userSign":"(一个纠结的面瘫伪宅)","message":"试了一下确实好用<img src=\"/img/smiles/tv/01.gif\" smileid=\"40\" alt=\"(bgm24)\">","sub":[]},{"avatar":"//lain.bgm.tv/pic/user/m/000/13/30/133075.jpg","floor":"#4","id":"1324695","time":"2018-3-8 23:37","userId":"liaune","userName":"君寻","userSign":"(学会欣赏不完美)","message":"@   grant 也支持？<br>能不能支持一下 @require","sub":[]},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/10/1010.jpg","floor":"#5","id":"1324720","time":"2018-3-9 04:23","userId":"fireattack","userName":"烈之斩","userSign":"(V1046-R MAHORO)","message":"看了这个Guide感觉更迷糊了<br><br>“正则请以 /^ 开头”这个说法有误<br><br>下面的不以/^开头的正则也可以工作：<br><br><div class=\"codeHighlight\"><pre>// @include  872\\d\\d</pre></div><br><br>可以匹配到 <a href=\"http://bgm.tv/subject/187276\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://bgm.tv/subject/187276</a><br><br>如果要用^（从头匹配）：<br><br><div class=\"codeHighlight\"><pre>// @include  ^http://bangumi\\.tv/.+</pre></div><br><br>也能工作，所以最前面加/是不必要的<br>不过，这种处理方式就很怪了。US或者说JS里的正则要两边都用\"/\"包住的，所以我上面的例子（左右都没用“/”）应该是不合法的，我试了下chrome+tampermonkey也是无效，但是这里就有效。<br><br>至于sai给的例子：<br><div class=\"codeHighlight\"><pre>// @include  /^(https?://bgm\\.tv|http://(bgm\\.tv|bangumi\\.tv|chii\\.in))/(user/.*|(anime|book|music|game|real)/list/.*)<br></pre></div><br>就更怪，只有左边有“/”，右边反而没有。虽然我试了下chrome+tampermonkey这样确实也行，但是为什么不用正规的语法呢？<br><br>而且这个结果也非常出人意料：<br>如果使用：（只有左边有/，右边没有）<br><div class=\"codeHighlight\"><pre>// @include  /872\\d\\d</pre></div><br><br>tampermonkey可以正确匹配 <a href=\"http://bgm.tv/subject/187276\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://bgm.tv/subject/187276</a>， bangumi则不行；<br>实际上，如果这么写就把/当成字符了，改成 <div class=\"codeHighlight\"><pre>// @include  /1872\\d\\d</pre></div> 就能匹配。<br><br>如果使用左右两边都有“/”的标准写法：<br><div class=\"codeHighlight\"><pre>// @include  /872\\d\\d/</pre></div><br><br>tampermonkey自然可以正常匹配 <a href=\"http://bgm.tv/subject/187276\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">http://bgm.tv/subject/187276</a>， bangumi因为上述的原因则完全不行。<br><br>TL;DR:<br><br>1) 应该只有在用户使用\"/\"两边包裹了字符串（正则字符串）的情况下才把@include 当做正则，其他时候则只做通配符匹配<br>  1.1) 目前的情况是包了反而会导致匹配时把加的“/”当做反斜杠字符来处理，和Tampermonkey等工作方式冲突<br>  1.2) Tampermonkey额外支持只在开头加\"/\"、末尾不加的非标准写法，bangumi不能完美支持，也不推荐支持。所以，那个用正则的范例最好修改一下<br>  <br>2) “正则请以 /^ 开头”这个说法不符合现在的工作方式（1. 系统其实支持不从头匹配；另参见1.2）。最好移除或者澄清","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/34/68/346809.jpg","floor":"#5-1","id":"1324739","time":"2018-3-9 09:12","userId":"windrises","userName":"windrises","userSign":"","message":"那个范例其实是我写的，后面确实漏了一个/，因为油猴能正常解析就没注意这个细节，我的锅<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">"},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/00/1.jpg","floor":"#5-2","id":"1324750","time":"2018-3-9 10:06","userId":"sai","userName":"Sai🖖","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">windrises</span> 说: 那个范例其实是我写的，后面确实漏了一个/，因为油猴能正常解析就没注意这个细节，我的锅</q></div>我还以为是什么特殊规则"},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/00/1.jpg","floor":"#5-3","id":"1324848","time":"2018-3-9 15:02","userId":"sai","userName":"Sai🖖","userSign":"","message":"好了，现在按照 <a href=\"https://developer.chrome.com/extensions/match_patterns\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://developer.chrome.com/extensions/match_patterns</a> 的规范来实现，完整的正则规则也是可以用的。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/10/1010.jpg","floor":"#5-4","id":"1324854","time":"2018-3-9 16:03","userId":"fireattack","userName":"烈之斩","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">Sai</span> 说: 好了，现在按照 https://developer.chrome.com/extensions/match_patterns 的规范来实现，完整的正则规则也是可以用的。</q></div>赞"}]}]
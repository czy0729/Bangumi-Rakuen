[{"avatar":"//lain.bgm.tv/pic/user/m/000/07/94/79410.jpg","floor":"#2","id":"1162250","time":"2016-6-13 21:45","userId":"ks_magi","userName":"ks.magi","userSign":"(2011 冬、始)","message":"Developer Tools > Console<br>localStorage.*","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#2-1","id":"1162291","time":"2016-6-13 22:46","userId":"laoism","userName":"林卯","userSign":"","message":"没看懂，全部删除？不是吧…"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/94/79410.jpg","floor":"#2-2","id":"1162394","time":"2016-6-14 09:39","userId":"ks_magi","userName":"ks.magi","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 没看懂，全部删除？不是吧…</q></div><div class=\"codeHighlight\"><pre><br>for (var key in localStorage) {<br>  if (key.startsWith('whatever') || key.test(/regexp/) || any_condition(key))<br>    delete localStorage[key]<br>}<br></pre></div>"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#2-3","id":"1162414","time":"2016-6-14 11:47","userId":"laoism","userName":"林卯","userSign":"","message":"虽然能猜到意思…但我并不懂这是什么，我不是程序员啊……"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/94/79410.jpg","floor":"#2-4","id":"1162424","time":"2016-6-14 12:35","userId":"ks_magi","userName":"ks.magi","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 虽然能猜到意思…但我并不懂这是什么，我不是程序员啊……</q></div>我不知道怎么解释<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\"><br>localStorage 是个 key-value 的对象所以很容易可以判断要不要删<img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#2-5","id":"1162425","time":"2016-6-14 12:50","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">ks.magi</span> 说: 我不知道怎么解释<br>localStorage 是个 key-value 的对象所以很容易可以判断要不要删</q></div>你当我什么都不懂即可——匹配项目名称和匹配项目值删除分别应该怎么做，举例：1.批量删除名称TopicTitle_ep_开头的项目，2.批量删除值只有\";;\"的项目。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/94/79410.jpg","floor":"#2-6","id":"1162440","time":"2016-6-14 14:23","userId":"ks_magi","userName":"ks.magi","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 你当我什么都不懂即可——匹配项目名称和匹配项目值删除分别应该怎么做，举例：1.批量删除名称TopicTitle_ep_开头的项目，2.批量删除值只有\";;\"的项目。</q></div>可能需要较新的浏览器版本<br><div class=\"codeHighlight\"><pre><br>for (let key of Object.keys(localStorage)) {<br>  let value = localStorage[key];<br>  if (key.startsWith('TopicTitle_ep_') || value == ';;')<br>    delete localStorage[key];<br>}<br></pre></div>"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#2-7","id":"1162477","time":"2016-6-14 17:05","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">ks.magi</span> 说: 可能需要较新的浏览器版本<br><br>for (let key of Object.keys(localStorage)) {<br>&nbsp;&nbsp;let value = localStorage[key]...</q></div>这是可以直接复制粘贴进控制台回车执行的吗？<br>“||”表达的意思是？"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/61/76150.jpg","floor":"#2-8","id":"1162485","time":"2016-6-14 17:36","userId":"binota","userName":"' ","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯(id: laoism)</span> 说: 这是可以直接复制粘贴进控制台回车执行的吗？<br>“||”表达的意思是？</q></div>|| 逻辑「或」<br>key.startWith('something') 或 value 等于 ';;'"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#2-9","id":"1162488","time":"2016-6-14 17:45","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">BinotaLIU</span> 说: || 逻辑「或」<br>key.startWith('something') 或 value 等于 ';;'</q></div>好像看懂了，准备试试。话说匹配不需要用星号来标识吗？比如说会不会误删\"xxxTopicTitle_ep_1234\"这样的？"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/61/76150.jpg","floor":"#2-10","id":"1162492","time":"2016-6-14 17:59","userId":"binota","userName":"' ","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯(id: laoism)</span> 说: 好像看懂了，准备试试。话说匹配不需要用星号来标识吗？比如说会不会误删\"xxxTopicTitle_ep_1234\"这样的？</q></div>不会，因为是 startWith"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/09/57/95768.jpg","floor":"#3","id":"1162255","time":"2016-6-13 21:58","userId":"a_little","userName":"拿月亮自刎","userSign":"(情更怯)","message":"个人认为上千条是不可能的， 脚本使用的localStorage item应该是固定的，除非该脚本作者刻意创建更多无用的项。<br>如果觉得影响浏览网页体验禁用不常使用的脚本即可。<br>另外还可以在控制台输入localStorage.clear()  （注意该方法有风险），这样可以清除不需要的项，当然也丢失也以前的设置。<br>退一步讲清理的方法：<br>个人的思路是搜集localStorage里认为不需要的项的key，建立一个list。<br>在控制台遍历一遍该list，将每一项置为localStorage.* 置清空。保存该list 定期重新清理一遍<br>不知lz是想通过webappsstore.sqlite清理还是使用控制台清理？","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#3-1","id":"1162290","time":"2016-6-13 22:45","userId":"laoism","userName":"林卯","userSign":"","message":"其实是必然的，我先前用Chromium发现同样情况有发帖咨询过，找不着了。<br><br>有个脚本是记录最后回复位置，所以我每访问一个帖、每看一个ep、每看一个角色或人物就会生成单独一行。bgm现在的帖子数已经排到30万了，从历史纪录看我一个月是能访问个上千不重复的。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/09/57/95768.jpg","floor":"#3-2","id":"1162314","time":"2016-6-13 23:44","userId":"a_little","userName":"拿月亮自刎","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 其实是必然的，我先前用Chromium发现同样情况有发帖咨询过，找不着了。<br><br>有个脚本是记录最后回复位置，所以我每访问一个帖、每看一个ep、每看一个角色或人物就会生成单独一行。bgm现在的帖子数已经排...</q></div>根据你描述又有了一个思路： 通过对比今天和最近十天左右localStorage的变化，然后找出没有变化的项，即常用项。再找出最近的使用项。保留这两部分即可。<br>常用项好解决，第二部分我使用SQLiteDatabaseBrowser查看了一下webappsstore.sqlite，没发现有写入时间这一项（也许有，个人不懂数据库没找到）。暂时没思路。<br>最好的解决方法是修改该脚本为其保存的localStorage item，添加prefix和suffix。方便查找清理。<br>另外查阅这篇文章<a href=\"https://www.stevesouders.com/blog/2014/02/11/measuring-localstorage-performance/\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">Measuring localStorage Performance</a>。使用极限的大小的字符串（5120KB）大约查询时间为1000ms，500KB查询时间需要100ms不等。一项1MB的字符串比1000项1KB字符串更慢。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#3-3","id":"1162323","time":"2016-6-14 00:16","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">拿月亮自刎</span> 说: 根据你描述又有了一个思路： 通过对比今天和最近十天左右localStorage的变化，然后找出没有变化的项，即常用项。再找出最近的使用项。保留这两部分即可。<br>常用项好解决，第二部分我使用SQLiteD...</q></div>有没有可能，把时间当作数据来记录，比如<br>“2016-06-14 00:16:23：有没有可能，把时间当作数据来记录，比如”"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#3-4","id":"1162415","time":"2016-6-14 11:53","userId":"laoism","userName":"林卯","userSign":"","message":"呃，刚才一看，localStorage突然就涨到959个项目（截至本文发布时），吓一跳，指数增长吗…"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/61/76150.jpg","floor":"#4","id":"1162265","time":"2016-6-13 22:23","userId":"binota","userName":"' ","userSign":"","message":"如果是我的腳本的話，我都有加 prefix 所以很好清理的……<br>或者說，你具體想實現怎麼樣的清理方案呢？","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#4-1","id":"1162295","time":"2016-6-13 22:48","userId":"laoism","userName":"林卯","userSign":"","message":"你脚本产生的我看到了。<br>需求简化就2点，可搜索和可批量删除。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/08/95/89561.jpg","floor":"#4-2","id":"1162352","time":"2016-6-14 04:37","userId":"upsuper","userName":"upsuper","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 你脚本产生的我看到了。<br>需求简化就2点，可搜索和可批量删除。</q></div>我的也应该都有加prefix……"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#4-3","id":"1162416","time":"2016-6-14 12:03","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">upsuper</span> 说: 我的也应该都有加prefix……</q></div>我以为TopicTitle_ep_开头的是BinotaLIU标题汉化脚本创建的，但我见他前缀是binota，突然想起来好像是你的讨论增强脚本？这个前缀好壮观啊。<br><br>你不考虑所有脚本都用upsupe前缀吗？或者纽交所代码风格的UPSU？咦…<a href=\"http://bgm.tv/group/topic/340543\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">我想到一个点子</a>。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/61/76150.jpg","floor":"#4-4","id":"1162491","time":"2016-6-14 17:58","userId":"binota","userName":"' ","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯(id: laoism)</span> 说: 我以为TopicTitle_ep_开头的是BinotaLIU标题汉化脚本创建的，但我见他前缀是binota，突然想起来好像是你的讨论增强脚本？这个前缀好壮观啊。<br><br>你不考虑所有脚本都用upsupe前缀...</q></div>标题汉化脚本也是 upsuper 的 <img src=\"/img/smiles/tv/15.gif\" smileid=\"54\" alt=\"(bgm38)\">"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#4-5","id":"1162493","time":"2016-6-14 18:12","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">BinotaLIU</span> 说: 标题汉化脚本也是 upsuper 的 </q></div>咦？为什么在你名下？<br>章节页显示中文名称 <a href=\"https://github.com/bangumi/scripts/blob/master/binota/bangumi-episode-chinese.user.js?raw=true\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://github.com/bangumi/scrip ... se.user.js?raw=true</a>"},{"avatar":"//lain.bgm.tv/pic/user/m/000/07/61/76150.jpg","floor":"#4-6","id":"1162494","time":"2016-6-14 18:14","userId":"binota","userName":"' ","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯(id: laoism)</span> 说: 咦？为什么在你名下？<br>章节页显示中文名称 https://github.com/bangumi/scrip ... se.user.js?raw=true</q></div>我以为你说的是这个……<br><a href=\"https://github.com/bangumi/scripts/blob/master/upsuper/name_chinesizer.user.js\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://github.com/bangumi/scrip ... _chinesizer.user.js</a>"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/13/90/139091.jpg","floor":"#5","id":"1162333","time":"2016-6-14 02:03","userId":"chaucerling","userName":"chaucer","userSign":"(あなたの傷は私の食べ物)","message":"看哪个脚本没prefix就提issue","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#5-1","id":"1162497","time":"2016-6-14 18:22","userId":"laoism","userName":"林卯","userSign":"","message":"我并没有注册GitHub(这个网站一般国人怎么称呼？)"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/26/12630.jpg","floor":"#5-2","id":"1162676","time":"2016-6-15 17:19","userId":"gongt","userName":"魂魄妖梦","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 我并没有注册GitHub(这个网站一般国人怎么称呼？)</q></div>就叫github，也可以叫<span style=\"background-color:#555;color:#555;border:1px solid #555;\">同性编程交友社区</span>"},{"avatar":"//lain.bgm.tv/pic/user/m/000/17/78/177820.jpg","floor":"#5-3","id":"1163115","time":"2016-6-17 07:36","userId":"franklinyu","userName":"Franklin Yu","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">魂魄妖梦</span> 说: 就叫github，也可以叫同性编程交友社区</q></div>+1"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/03/68/36817.jpg","floor":"#6","id":"1162407","time":"2016-6-14 11:09","userId":"acgotaku","userName":"≮雪月秋水☆","userSign":"(爱动漫，宅！‮‮‮‮‮‮‮‮‮‮‮‮ ... ... )","message":"<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/File_System_API/Introduction\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://developer.mozilla.org/en ... em_API/Introduction</a><br><br>其实还有这个也可以存数据 上限是2GB。。。","sub":[]},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/10/1010.jpg","floor":"#7","id":"1162446","time":"2016-6-14 14:54","userId":"fireattack","userName":"烈之斩","userSign":"(V1046-R MAHORO)","message":"顺便说一句Firefox的localStorage有极大的性能问题，webappsstore.sqlite文件一大（我这40M）严重影响某些网页（一个明显的例子是Youtube）的UI流畅性<br><br>好在webappsstore.sqlite要被干掉了","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#7-1","id":"1162478","time":"2016-6-14 17:06","userId":"laoism","userName":"林卯","userSign":"","message":"会被什么取代？"},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/10/1010.jpg","floor":"#7-2","id":"1162588","time":"2016-6-15 03:43","userId":"fireattack","userName":"烈之斩","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 会被什么取代？</q></div><a href=\"https://bugzilla.mozilla.org/show_bug.cgi?id=742822\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://bugzilla.mozilla.org/show_bug.cgi?id=742822</a>"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/26/12630.jpg","floor":"#8","id":"1162675","time":"2016-6-15 17:18","userId":"gongt","userName":"魂魄妖梦","userSign":"(我去前面探探路！)","message":"在现在这个页面里，按F12，切到“控制台”，输入“localStorage.clear()”然后回车即可","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#8-1","id":"1162831","time":"2016-6-16 00:05","userId":"laoism","userName":"林卯","userSign":"","message":"你觉得我会做吗。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/26/12630.jpg","floor":"#8-2","id":"1162845","time":"2016-6-16 02:14","userId":"gongt","userName":"魂魄妖梦","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 你觉得我会做吗。</q></div>[url=javascript:localStorage.clear();]javascript:localStorage.clear();[/url]"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/26/12630.jpg","floor":"#8-3","id":"1162847","time":"2016-6-16 02:15","userId":"gongt","userName":"魂魄妖梦","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 你觉得我会做吗。</q></div>好吧不管用。。。。那就清空缓存吧（"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#8-4","id":"1162944","time":"2016-6-16 13:03","userId":"laoism","userName":"林卯","userSign":"","message":"感觉你没有看过#2-6？"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/28/2813.jpg","floor":"#9","id":"1162849","time":"2016-6-16 03:01","userId":"ruocaled","userName":"若卡","userSign":"(✨️VIP 8✨️)","message":"我怎么觉得以前看过这个帖子……<img src=\"/img/smiles/bgm/05.png\" smileid=\"21\" alt=\"(bgm05)\">","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#9-1","id":"1162943","time":"2016-6-16 13:02","userId":"laoism","userName":"林卯","userSign":"","message":"我以前发的是关于不小心清空铬的本地存储，找不到了，好像与这回不一样。"},{"avatar":"//lain.bgm.tv/pic/user/m/000/00/28/2813.jpg","floor":"#9-2","id":"1162951","time":"2016-6-16 13:52","userId":"ruocaled","userName":"若卡","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">林卯</span> 说: 我以前发的是关于不小心清空铬的本地存储，找不到了，好像与这回不一样。</q></div><a href=\"https://bgm.tv/group/topic/312365\" target=\"_blank\" rel=\"nofollow external noopener\" class=\"l\">https://bgm.tv/group/topic/312365</a> 有点可怕"},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#9-3","id":"1162952","time":"2016-6-16 14:00","userId":"laoism","userName":"林卯","userSign":"","message":"<div class=\"quote\"><q><span style=\"font-weight:bold;\">若卡</span> 说: https://bgm.tv/group/topic/312365 有点可怕</q></div>原来我当时是想迁移然后误删来着。对了这也是个问题。"}]},{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#10","id":"1163256","time":"2016-6-18 00:30","userId":"laoism","userName":"林卯","userSign":"(✨️VIP 8✨️)","message":"<div class=\"codeHighlight\"><pre>for (let key of Object.keys(localStorage)) {<br>  let value = localStorage[key];<br>  if (key.startsWith('TopicTitle_') || value == ';;')<br>    delete localStorage[key];<br>}</pre></div>好用！","sub":[]},{"avatar":"//lain.bgm.tv/pic/user/m/000/12/21/122168.jpg","floor":"#11","id":"1163973","time":"2016-6-21 10:18","userId":"zhq","userName":"梦","userSign":"(就让我一直沉睡到世界尽头)","message":"如果有需要 我可以远程控制进行支持<br>并进行适量的讲解~","sub":[{"avatar":"//lain.bgm.tv/pic/user/m/000/01/43/14382.jpg","floor":"#11-1","id":"1164002","time":"2016-6-21 12:30","userId":"laoism","userName":"林卯","userSign":"","message":"？目前已经解决了。"}]}]